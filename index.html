<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ ØªØ®ØµØµÛŒ Ø§Ù„Ú©ØªØ±ÛŒÚ©Ø§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- XLSX Library for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            overflow-x: hidden;
            background: #0a0a0a;
        }
        .hidden {
            display: none !important;
        }
        
        /* Animated Background with Moving Gradient */
        .animated-bg {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 25%, #0891b2 50%, #7c3aed 75%, #1e293b 100%);
            background-size: 400% 400%;
            animation: gradientFlow 20s ease infinite;
            z-index: -3;
        }
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Ø§Ø¹Ù…Ø§Ù„ ÙÙˆÙ†Øª Ø¨Ø±Ø§ÛŒ Ú©Ù„ Ø³Ø§ÛŒØª */
        body, 
        html:lang(fa), 
        [lang="fa"], 
        [dir="rtl"] {
            font-family: Tahoma, Arial, sans-serif !important;
        }
        
        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ø³Ø§ÛŒØ² ÙÙˆÙ†Øª Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ */
        .form-group input,
        .form-group select,
        .tab,
        .radio-option span,
        .calc-btn span,
        .export-btn span {
            font-size: 1.05em !important;
        }
        
        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§ */
        .formula-box p {
            font-size: 1.1em !important;
            line-height: 1.6 !important;
        }
        
        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¯Ø§Ø¯ */
        .result-value {
            font-size: 1.1em !important;
            letter-spacing: 0.5px;
        }
        
        /* Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„â€ŒÙ‡Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡ */
        @media (max-width: 768px) {
            body,
            html:lang(fa),
            [lang="fa"],
            [dir="rtl"] {
                font-size: 16px !important;
                line-height: 1.6 !important;
            }
            
            .header-text h1 {
                font-size: 2.2rem !important;
                line-height: 1.3 !important;
            }
            
            .calc-header h1 {
                font-size: 1.8rem !important;
                line-height: 1.4 !important;
            }
            
            .card-content h2 {
                font-size: 1.6rem !important;
                line-height: 1.4 !important;
            }
            
            .form-group input,
            .form-group select {
                font-size: 1.1em !important;
                padding: 0.9rem 1rem !important;
            }
        }
        
        /* Electrical Circuit Pattern Background */
        .circuit-bg {
            position: fixed;
            inset: 0;
            z-index: -2;
            opacity: 0.15;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 100px, rgba(59, 130, 246, 0.3) 100px, rgba(59, 130, 246, 0.3) 102px),
                repeating-linear-gradient(90deg, transparent, transparent 100px, rgba(59, 130, 246, 0.3) 100px, rgba(59, 130, 246, 0.3) 102px),
                repeating-linear-gradient(45deg, transparent, transparent 50px, rgba(8, 145, 178, 0.2) 50px, rgba(8, 145, 178, 0.2) 51px),
                repeating-linear-gradient(-45deg, transparent, transparent 50px, rgba(8, 145, 178, 0.2) 50px, rgba(8, 145, 178, 0.2) 51px);
            animation: circuitMove 60s linear infinite;
        }
        @keyframes circuitMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(100px, 100px); }
        }
        
        /* Circuit Nodes */
        .circuit-bg::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(59, 130, 246, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 30% 40%, rgba(8, 145, 178, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 50% 60%, rgba(139, 92, 246, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 70% 30%, rgba(59, 130, 246, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 90% 70%, rgba(8, 145, 178, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 20% 80%, rgba(139, 92, 246, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 60% 10%, rgba(59, 130, 246, 0.4) 2px, transparent 3px),
                radial-gradient(circle at 80% 50%, rgba(8, 145, 178, 0.4) 2px, transparent 3px);
            background-size: 200px 200px;
            animation: nodesGlow 4s ease-in-out infinite;
        }
        @keyframes nodesGlow {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Electric Lightning Effect */
        .lightning-container {
            position: fixed;
            inset: 0;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }
        .lightning {
            position: absolute;
            width: 2px;
            height: 100%;
            background: linear-gradient(to bottom, 
                transparent 0%, 
                rgba(59, 130, 246, 0.8) 30%, 
                rgba(139, 92, 246, 0.8) 50%, 
                rgba(59, 130, 246, 0.8) 70%, 
                transparent 100%);
            opacity: 0;
            animation: lightning 8s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.8);
        }
        .lightning:nth-child(1) { left: 10%; animation-delay: 0s; }
        .lightning:nth-child(2) { left: 30%; animation-delay: 2s; }
        .lightning:nth-child(3) { left: 50%; animation-delay: 4s; }
        .lightning:nth-child(4) { left: 70%; animation-delay: 6s; }
        .lightning:nth-child(5) { left: 90%; animation-delay: 1s; }
        @keyframes lightning {
            0%, 90%, 100% { opacity: 0; transform: scaleY(0); }
            91% { opacity: 1; transform: scaleY(1); }
            92% { opacity: 0; transform: scaleY(1); }
            93% { opacity: 1; transform: scaleY(1); }
            94%, 100% { opacity: 0; transform: scaleY(1); }
        }
        
        /* Animated Mesh Overlay */
        .animated-bg::before {
            content: '';
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 92, 246, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(8, 145, 178, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(236, 72, 153, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 90% 20%, rgba(59, 130, 246, 0.3) 0%, transparent 50%);
            animation: meshMove 25s ease infinite;
        }
        @keyframes meshMove {
            0%, 100% { opacity: 0.5; transform: scale(1) rotate(0deg); }
            33% { opacity: 0.7; transform: scale(1.2) rotate(120deg); }
            66% { opacity: 0.6; transform: scale(0.9) rotate(240deg); }
        }
        
        /* Floating Particles */
        .particles {
            position: fixed;
            inset: 0;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            animation: floatParticle 20s infinite;
        }
        @keyframes floatParticle {
            0%, 100% {
                transform: translateY(0) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translateY(-20vh) translateX(20px) scale(1);
            }
            90% {
                opacity: 1;
                transform: translateY(-90vh) translateX(-50px) scale(1);
            }
            100% {
                transform: translateY(-100vh) translateX(100px) scale(0);
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(60px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-60px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        @keyframes glowPulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.4),
                            0 0 40px rgba(139, 92, 246, 0.2);
            }
            50% {
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.6),
                            0 0 80px rgba(139, 92, 246, 0.4);
            }
        }
        
        /* Page Container */
        .page {
            display: none;
            min-height: 100vh;
            padding: 2rem;
            animation: fadeIn 0.6s ease-out;
        }
        .page.active {
            display: block;
        }
        
        /* Welcome Page */
        .welcome-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header with Logo */
        .welcome-header {
            display: flex;
            align-items: center;
            gap: 3rem;
            margin-bottom: 4rem;
            animation: slideInRight 0.8s ease-out;
        }
        
        /* Logo Container */
        .logo-container {
            width: 120px;
            height: 120px;
            position: relative;
            flex-shrink: 0;
            animation: pulse 3s ease-in-out infinite;
        }
        .logo-ring {
            position: absolute;
            inset: -8px;
            transform: rotate(45deg);
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.4), rgba(139, 92, 246, 0.4));
            backdrop-filter: blur(20px);
            border: 3px solid rgba(255, 255, 255, 0.3);
            animation: rotate 20s linear infinite, glowPulse 3s ease-in-out infinite;
        }
        .logo-inner {
            position: absolute;
            inset: 0;
            transform: rotate(45deg);
            border-radius: 18px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 2px 10px rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        .logo-inner::before {
            content: '';
            position: absolute;
            inset: -50%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 3s infinite;
        }
        .logo-inner img {
            width: 70%;
            height: 70%;
            object-fit: contain;
            position: relative;
            z-index: 2;
            transform: rotate(-45deg);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        
        /* Header Text */
        .header-text {
            flex: 1;
            color: white;
        }
        .header-text h1 {
            font-size: clamp(2rem, 5vw, 3.2rem);
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #fff, #e0e7ff, #c7d2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            position: relative;
        }
        .header-text h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 0;
            width: 200px;
            height: 4px;
            background: linear-gradient(90deg, transparent, #3b82f6, #8b5cf6);
            border-radius: 2px;
        }
        .header-text p {
            font-size: clamp(1.1rem, 3vw, 1.8rem);
            opacity: 0.95;
            margin-bottom: 0.5rem;
        }
        .subtitle {
            font-size: clamp(0.9rem, 2vw, 1.2rem);
            opacity: 0.85;
        }
        
        /* Calculator Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
            animation: slideInUp 0.8s ease-out 0.2s both;
        }
        .calc-card {
            position: relative;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 30px 80px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        .calc-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.1), 
                rgba(139, 92, 246, 0.1), 
                rgba(236, 72, 153, 0.1));
            opacity: 0;
            transition: opacity 0.3s;
        }
        .calc-card:hover {
            transform: translateY(-20px) scale(1.02);
            box-shadow: 
                0 50px 100px rgba(0, 0, 0, 0.6),
                0 0 80px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            border-color: rgba(59, 130, 246, 0.5);
        }
        .calc-card:hover::before {
            opacity: 1;
        }
        
        /* Card Image Area */
        .card-image {
            height: 300px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        .card-image::before {
            content: '';
            position: absolute;
            inset: 0;
            background: 
                repeating-linear-gradient(45deg, transparent, transparent 20px, rgba(255,255,255,0.03) 20px, rgba(255,255,255,0.03) 40px);
            animation: slidePattern 20s linear infinite;
        }
        @keyframes slidePattern {
            0% { transform: translate(0, 0); }
            100% { transform: translate(40px, 40px); }
        }
        .card-image img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5));
            transition: transform 0.5s;
        }
        .calc-card:hover .card-image img {
            transform: scale(1.1) rotate(5deg);
        }
        
        /* Card Content */
        .card-content {
            padding: 2.5rem;
            background: linear-gradient(135deg, rgba(8, 145, 178, 0.9), rgba(14, 116, 144, 0.9));
            backdrop-filter: blur(10px);
            color: white;
            position: relative;
            overflow: hidden;
        }
        .calc-card.blue .card-content {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.9), rgba(30, 64, 175, 0.9));
        }
        .card-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            animation: shimmer 3s infinite;
        }
        .card-content h2 {
            font-size: 1.8rem;
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        .card-content h2 .emoji {
            font-size: 2rem;
            animation: pulse 2s ease-in-out infinite;
        }
        .card-content p {
            font-size: 1.1rem;
            line-height: 1.8;
            opacity: 0.95;
            margin-bottom: 2rem;
        }
        .card-cta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 1.1rem;
            font-weight: 600;
        }
        .card-cta .arrow {
            font-size: 1.8rem;
            transition: transform 0.3s;
        }
        .calc-card:hover .card-cta .arrow {
            transform: translateX(-10px);
            animation: pulse 1s ease-in-out infinite;
        }
        
        /* Footer Badge */
        .footer-badge {
            text-align: center;
            animation: slideInUp 0.8s ease-out 0.4s both;
        }
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            padding: 1.2rem 2.5rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(30px);
            border-radius: 50px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.1rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .version-tag {
            background: rgba(255, 255, 255, 0.25);
            padding: 0.4rem 1rem;
            border-radius: 25px;
            font-weight: 700;
        }
        
        /* Calculator Page */
        .calc-container {
            max-width: 1800px;
            margin: 0 auto;
        }
        .calc-header {
            background: linear-gradient(135deg, rgba(8, 145, 178, 0.95), rgba(14, 116, 144, 0.95));
            backdrop-filter: blur(20px);
            color: white;
            padding: 2rem;
            border-radius: 30px;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 25px 60px rgba(8, 145, 178, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            animation: slideInUp 0.6s ease-out;
        }
        .calc-header::before {
            content: '';
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.15) 0%, transparent 50%);
            animation: meshMove 15s ease-in-out infinite;
        }
        .calc-header > * {
            position: relative;
            z-index: 1;
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.9rem 1.8rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            transition: all 0.3s;
        }
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(8px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .calc-header h1 {
            font-size: clamp(1.6rem, 4vw, 2.5rem);
            margin-bottom: 0.6rem;
        }
        .calc-header p {
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            opacity: 0.95;
        }
        
        /* Calculator Grid */
        .calc-grid {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 2rem;
        }
        @media (max-width: 1200px) {
            .calc-grid {
                grid-template-columns: 1fr;
            }
        }
        .calc-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 
                0 25px 60px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            animation: slideInUp 0.6s ease-out;
        }
        .calc-panel:nth-child(2) {
            animation-delay: 0.1s;
        }
        .panel-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #e0e7ff;
        }
        .panel-header svg {
            width: 28px;
            height: 28px;
            fill: #0891b2;
            filter: drop-shadow(0 2px 4px rgba(8, 145, 178, 0.3));
        }
        .panel-header h2 {
            font-size: 1.4rem;
            color: #1e293b;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #e0f2fe, #dbeafe);
            padding: 0.5rem;
            border-radius: 20px;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .tab {
            flex: 1;
            padding: 0.8rem 1rem;
            background: transparent;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 700;
            color: #475569;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        .tab:hover {
            background: rgba(8, 145, 178, 0.1);
            transform: translateY(-2px);
        }
        .tab.active {
            background: linear-gradient(135deg, #0891b2, #0e7490);
            color: white;
            box-shadow: 0 8px 20px rgba(8, 145, 178, 0.4);
            transform: translateY(-2px);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 1.2rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 700;
            color: #1e293b;
            font-size: 0.9rem;
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid #cbd5e1;
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.3s;
            background: white;
            font-weight: 500;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #0891b2;
            box-shadow: 0 0 0 4px rgba(8, 145, 178, 0.2);
            transform: translateY(-2px);
        }
        .form-group small {
            display: block;
            margin-top: 0.4rem;
            font-size: 0.8rem;
            color: #64748b;
        }
        
        /* Radio Options */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }
        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.9rem 1.2rem;
            background: linear-gradient(135deg, #e0f2fe, #dbeafe);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            border: 2px solid transparent;
            font-size: 0.9rem;
        }
        .radio-option:hover {
            background: linear-gradient(135deg, #bae6fd, #bfdbfe);
            transform: translateX(-5px);
            border-color: #0891b2;
        }
        .radio-option input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .core-type-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
            margin-top: 0.6rem;
        }
        .core-option {
            background: linear-gradient(135deg, #e0f2fe, #dbeafe);
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            border: 2px solid transparent;
            font-size: 0.9rem;
        }
        .core-option:hover {
            background: linear-gradient(135deg, #bae6fd, #bfdbfe);
            transform: scale(1.05) rotate(2deg);
            border-color: #0891b2;
        }
        .core-option.selected {
            background: linear-gradient(135deg, #0891b2, #0e7490);
            color: white;
            box-shadow: 0 8px 20px rgba(8, 145, 178, 0.4);
            border-color: #06b6d4;
        }
        
        /* Calculate Button */
        .calc-btn {
            width: 100%;
            padding: 1.2rem;
            margin-top: 1.5rem;
            background: linear-gradient(135deg, #0891b2, #0e7490);
            color: white;
            border: none;
            border-radius: 18px;
            font-size: 1.2rem;
            font-weight: 800;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            box-shadow: 0 15px 40px rgba(8, 145, 178, 0.4);
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }
        .calc-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        .calc-btn:hover::before {
            transform: translateX(100%);
        }
        .calc-btn:hover {
            background: linear-gradient(135deg, #0e7490, #155e75);
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(8, 145, 178, 0.6);
        }
        .calc-btn:active {
            transform: translateY(-2px);
        }
        .calc-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .calc-btn svg {
            width: 24px;
            height: 24px;
            fill: white;
        }
        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: rotate 1s linear infinite;
        }
        
        /* Export Button */
        .export-btn {
            width: 100%;
            padding: 1rem;
            margin-top: 1rem;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
            transition: all 0.3s;
        }
        .export-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.6);
        }
        .export-btn svg {
            width: 22px;
            height: 22px;
            fill: white;
        }
        
        /* Formula Box */
        .formula-box {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            padding: 1.5rem;
            border-radius: 18px;
            margin-top: 1.5rem;
            border: 3px solid #93c5fd;
            box-shadow: 
                0 8px 20px rgba(59, 130, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }
        .formula-box h3 {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            margin-bottom: 1rem;
            color: #1e3a8a;
            font-size: 1rem;
        }
        .formula-box h3 svg {
            width: 20px;
            height: 20px;
            fill: #1e3a8a;
        }
        .formula-box p {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #1e3a8a;
            line-height: 1.8;
            font-weight: 600;
            margin-bottom: 0.4rem;
        }
        
        /* Results */
        .result-placeholder {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, #f8fafc, #e0f2fe);
            border: 3px dashed #cbd5e1;
            border-radius: 25px;
        }
        .result-placeholder-icon {
            width: 90px;
            height: 90px;
            margin: 0 auto 1.2rem;
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s ease-in-out infinite;
        }
        .result-placeholder-icon svg {
            width: 50px;
            height: 50px;
            fill: #0891b2;
        }
        .result-placeholder p {
            font-size: 1.1rem;
            color: #64748b;
        }
        .result-section {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: white;
            border: 3px solid #e5e7eb;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            animation: slideInUp 0.4s ease-out;
        }
        .result-section:hover {
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            border-color: #bae6fd;
            transform: translateY(-3px);
        }
        .result-section h3 {
            color: #1e293b;
            margin-bottom: 1.2rem;
            padding-bottom: 0.8rem;
            border-bottom: 3px solid #e5e7eb;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0.6rem 0;
            padding: 1rem 1.2rem;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 12px;
            border-right: 4px solid #0891b2;
            transition: all 0.3s;
        }
        .result-item:hover {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            transform: translateX(-8px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .result-item.highlight {
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            border-right-color: #0e7490;
        }
        .result-label {
            color: #64748b;
            font-weight: 700;
            font-size: 0.95rem;
        }
        .result-value {
            color: #1e293b;
            font-weight: 800;
            font-size: 1.05rem;
            font-family: 'Courier New', monospace;
        }
        .result-item.highlight .result-value {
            color: #0e7490;
        }
        
        /* Calculation Steps */
        .calc-steps {
            background: linear-gradient(135deg, #f8fafc, #e5e7eb);
            padding: 1.5rem;
            border-radius: 18px;
            border: 3px solid #cbd5e1;
            margin-top: 1.5rem;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .calc-steps h3 {
            margin-bottom: 1.2rem;
            color: #1e293b;
            font-size: 1.1rem;
        }
        .step {
            margin-bottom: 0.8rem;
            padding: 1.2rem;
            background: white;
            border-radius: 12px;
            border-right: 4px solid #0891b2;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            animation: slideInUp 0.3s ease-out;
            transition: all 0.3s;
        }
        .step:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        .step strong {
            color: #1e293b;
        }
        
        /* Warning Box */
        .warning-box {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            padding: 1.5rem;
            border-radius: 18px;
            margin-top: 1.5rem;
            border: 3px solid #f87171;
            animation: slideInUp 0.3s ease-out;
            box-shadow: 0 8px 20px rgba(248, 113, 113, 0.2);
        }
        .warning-box h4 {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            margin-bottom: 1rem;
            color: #991b1b;
            font-size: 1.1rem;
        }
        .warning-box h4 svg {
            width: 22px;
            height: 22px;
            fill: #991b1b;
        }
        .warning-box ul {
            list-style: disc;
            padding-right: 1.5rem;
            line-height: 1.8;
            color: #991b1b;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* Success Box */
        .success-box {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            padding: 1.5rem;
            border-radius: 18px;
            margin-top: 1.5rem;
            border: 3px solid #86efac;
            animation: slideInUp 0.3s ease-out;
            box-shadow: 0 8px 20px rgba(134, 239, 172, 0.2);
        }
        .success-box h4 {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            margin-bottom: 1rem;
            color: #166534;
            font-size: 1.1rem;
        }
        .success-box h4 svg {
            width: 22px;
            height: 22px;
            fill: #166534;
        }
        .success-box ul {
            list-style: disc;
            padding-right: 1.5rem;
            line-height: 1.8;
            color: #166534;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* Chart Modal Styles */
        .chart-modal {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease-out;
        }

        .chart-modal.active {
            display: flex;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 2rem;
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .close-chart {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            z-index: 10;
            transition: all 0.3s;
        }

        .close-chart:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }

        .chart-title {
            text-align: center;
            margin-bottom: 2rem;
            color: #1e293b;
            font-size: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #0891b2;
        }

        .chart-wrapper {
            width: 100%;
            height: 400px;
            margin-bottom: 2rem;
            position: relative;
        }

        .chart-info {
            background: linear-gradient(135deg, #f8fafc, #e0f2fe);
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid #cbd5e1;
            margin-top: 1rem;
        }

        .chart-info h4 {
            color: #1e293b;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-info ul {
            list-style: none;
            padding: 0;
        }

        .chart-info li {
            margin-bottom: 0.5rem;
            color: #475569;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-info li::before {
            content: "â€¢";
            color: #0891b2;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Different colors for transformer chart */
        .transformer .chart-title {
            border-bottom-color: #2563eb;
        }

        .transformer .chart-info {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border-color: #bfdbfe;
        }

        .transformer .chart-info li::before {
            color: #2563eb;
        }

        /* Footer */
        .calc-footer {
            text-align: center;
            margin-top: 2rem;
        }
        
        .calc-footer .badge {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(30px);
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.3);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.8), rgba(8, 145, 178, 0.8));
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #2563eb, #0891b2);
        }
        
        /* Blue theme for Transformer */
        .calc-header.blue {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.95), rgba(30, 64, 175, 0.95));
        }
        .panel-header.blue svg {
            fill: #2563eb;
        }
        .tabs.blue {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
        }
        .tab.blue.active {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
        }
        .result-item.blue {
            border-right-color: #2563eb;
        }
        .result-item.highlight.blue {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-right-color: #1e40af;
        }
        .result-item.highlight.blue .result-value {
            color: #1e40af;
        }
        .step.blue {
            border-right-color: #2563eb;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            .welcome-header {
                flex-direction: column;
                text-align: center;
            }
            .header-text h1::after {
                right: 50%;
                transform: translateX(50%);
            }
            .calc-header {
                padding: 1.5rem;
            }
            .calc-panel {
                padding: 1.5rem;
            }
            .panel-header h2 {
                font-size: 1.2rem;
            }
            .calc-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    
    <!-- Circuit Background -->
    <div class="circuit-bg"></div>
    
    <!-- Lightning Effects -->
    <div class="lightning-container">
        <div class="lightning"></div>
        <div class="lightning"></div>
        <div class="lightning"></div>
        <div class="lightning"></div>
        <div class="lightning"></div>
    </div>
    
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>
    
    <!-- Welcome Page -->
    <div id="welcomePage" class="page active">
        <div class="welcome-container">
            <!-- Header with Logo -->
            <div class="welcome-header">
                <!-- Logo on Right -->
                <div class="logo-container">
                    <div class="logo-ring"></div>
                    <div class="logo-inner">
                        <img src="logo.png" alt="Logo" onerror="this.style.display='none';">
                    </div>
                </div>
                <!-- Header Text -->
                <div class="header-text">
                    <h1>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ø§Ù„Ú©ØªØ±ÛŒÚ©Ø§Ù„</h1>
                    <p>Ø§Ø¨Ø²Ø§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ø¨Ø±Ù‚</p>
                    <p class="subtitle">Ù„Ø·ÙØ§Ù‹ ÛŒÚ©ÛŒ Ø§Ø² Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</p>
                </div>
            </div>
            
            <!-- Calculator Cards -->
            <div class="cards-grid">
                <!-- Motor Calculator Card -->
                <div class="calc-card cyan" onclick="selectCalculator('motor')">
                    <div class="card-image">
                        <img src="t1.png" alt="Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±">
                    </div>
                    <div class="card-content">
                        <h2>
                            <span class="emoji">âš™ï¸</span>
                            <span>Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±</span>
                        </h2>
                        <p>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ± Ø³Ù‡ ÙØ§Ø² Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§ Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø§Ù†ÙˆØ§Ø¹ Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ</p>
                        <div class="card-cta">
                            <span>Ø´Ø±ÙˆØ¹ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</span>
                            <span class="arrow">â†</span>
                        </div>
                    </div>
                </div>
                
                <!-- Transformer Calculator Card -->
                <div class="calc-card blue" onclick="selectCalculator('transformer')">
                    <div class="card-image">
                        <img src="t2.png" alt="ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±">
                    </div>
                    <div class="card-content">
                        <h2>
                            <span class="emoji">ğŸ“Š</span>
                            <span>Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</span>
                        </h2>
                        <p>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚ ØªÙ…Ø§Ù… Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ± Ø¨Ø§ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø§Ù†ÙˆØ§Ø¹ Ù‡Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</p>
                        <div class="card-cta">
                            <span>Ø´Ø±ÙˆØ¹ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</span>
                            <span class="arrow">â†</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer Badge -->
            <div class="footer-badge">
                <div class="badge">
                    <span>Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ ØªÙˆØ³Ø·</span>
                    <strong>Ù¾Ø§Ø±Ø³Ø§</strong>
                    <span class="version-tag">Ù†Ø³Ø®Ù‡ Û².Û°</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Motor Calculator Page -->
    <div id="motorPage" class="page">
        <div class="calc-container">
            <!-- Header -->
            <div class="calc-header">
                <button class="back-btn" onclick="backToWelcome()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                    </svg>
                    <span>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</span>
                </button>
                <h1>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±</h1>
                <p>Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªØ®ØµØµÛŒ Ù…ÙˆØªÙˆØ±Ù‡Ø§ÛŒ Ø³Ù‡ ÙØ§Ø² â€” Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ</p>
            </div>
            
            <!-- Calculator Grid -->
            <div class="calc-grid">
                <!-- Input Panel -->
                <div class="calc-panel">
                    <div class="panel-header">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M12 1v6m0 6v6M1 12h6m6 0h6"/>
                        </svg>
                        <h2>ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§</h2>
                    </div>
                    
                    <!-- Tabs -->
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('basic', 'motor')">Ù¾Ø§ÛŒÙ‡</button>
                        <button class="tab" onclick="switchTab('winding', 'motor')">Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ</button>
                    </div>
                    
                    <!-- Basic Tab -->
                    <div id="motor-basic-tab" class="tab-content active">
                        <div class="form-group">
                            <label>ØªÙˆØ§Ù† (kW)</label>
                            <input type="number" id="motorPower" value="1.5" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label>ÙˆÙ„ØªØ§Ú˜ (V)</label>
                            <input type="number" id="motorVoltage" value="380" min="1">
                        </div>
                        <div class="form-group">
                            <label>Ø¬Ø±ÛŒØ§Ù† (A)</label>
                            <input type="number" id="motorCurrent" value="3.5" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label>ÙØ±Ú©Ø§Ù†Ø³ (Hz)</label>
                            <input type="number" id="motorFrequency" value="50" min="1">
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø±Ø¹Øª (RPM)</label>
                            <input type="number" id="motorRPM" value="1440" min="1">
                        </div>
                    </div>
                    
                    <!-- Winding Tab -->
                    <div id="motor-winding-tab" class="tab-content">
                        <div class="form-group">
                            <label>ØªØ¹Ø¯Ø§Ø¯ Ø´ÛŒØ§Ø±Ù‡Ø§ (Z)</label>
                            <input type="number" id="slotNumber" value="24" min="1">
                        </div>
                        <div class="form-group">
                            <label>ØªØ¹Ø¯Ø§Ø¯ ÙØ§Ø²Ù‡Ø§ (m)</label>
                            <input type="number" id="phaseNumber" value="3" disabled>
                        </div>
                        <div class="form-group">
                            <label>ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø·Ø¨â€ŒÙ‡Ø§ (P)</label>
                            <input type="number" id="poleNumber" value="4" min="2" step="2">
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="windingType" value="full" checked>
                                    <span>Ú¯Ø§Ù… Ú©Ø§Ù…Ù„</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="windingType" value="fractional">
                                    <span>Ú¯Ø§Ù… Ú©Ø³Ø±ÛŒ</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ù‚Ø·Ø± Ø³ÛŒÙ… (mm)</label>
                            <input type="number" id="wireDiameterMotor" value="0.8" min="0.1" max="5" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Ø§ØªØµØ§Ù„:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="connectionType" value="star" checked>
                                    <span>Ø³ØªØ§Ø±Ù‡ (Y)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="connectionType" value="delta">
                                    <span>Ù…Ø«Ù„Ø« (âˆ†)</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø·Ø­ Ù‡Ø³ØªÙ‡ (cmÂ²)</label>
                            <input type="number" id="coreArea" value="18" min="5" step="0.5">
                            <small>ØªØ®Ù…ÛŒÙ†: ~12 cmÂ² / kW</small>
                        </div>
                    </div>
                    
                    <!-- Calculate Button -->
                    <button class="calc-btn" onclick="calculateMotor()">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M16 12l-4-4v8z" fill="white"/>
                        </svg>
                        <span id="motorCalcBtnText">Ù…Ø­Ø§Ø³Ø¨Ù‡</span>
                    </button>
                    
                    <!-- Formula Box -->
                    <div class="formula-box">
                        <h3>
                            <svg viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4m0-4h.01" fill="white" stroke="white" stroke-width="2"/>
                            </svg>
                            <span>ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§:</span>
                        </h3>
                        <p>N<sub>s</sub> = 120f / P</p>
                        <p>Y<sub>P</sub> = Z / (2P)</p>
                        <p>q = Z / (2PÂ·m)</p>
                        <p>N<sub>ph</sub> = V / (4.44Â·fÂ·kÂ·BÂ·A)</p>
                    </div>
                </div>
                
                <!-- Results Panel -->
                <div class="calc-panel" style="max-height: none; overflow-y: visible;">
                    <div class="panel-header">
                        <svg viewBox="0 0 24 24">
                            <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
                        </svg>
                        <h2>Ù†ØªØ§ÛŒØ¬</h2>
                    </div>
                    <div id="motorResults">
                        <div class="result-placeholder">
                            <div class="result-placeholder-icon">
                                <svg viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M16 12l-4-4v8z"/>
                                </svg>
                            </div>
                            <p>Ù†ØªØ§ÛŒØ¬ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
                        </div>
                    </div>
                    <button class="export-btn hidden" id="motorExportBtn" onclick="exportMotorToExcel()">
                        <svg viewBox="0 0 24 24">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"/>
                            <path d="M14 2v6h6M12 18v-6M9 15l3 3 3-3"/>
                        </svg>
                        <span>Ø¯Ø§Ù†Ù„ÙˆØ¯ Excel</span>
                    </button>
                    <button class="export-btn hidden" id="motorChartBtn" onclick="showMotorChart()">
                        <svg viewBox="0 0 24 24">
                            <path d="M3 3v18h18"/>
                            <path d="M3 12l6-6 4 4 7-7"/>
                        </svg>
                        <span>Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø±</span>
                    </button>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="calc-footer">
                <div class="badge">
                    <span>Ø·Ø±Ø§Ø­ÛŒ ØªÙˆØ³Ø·</span>
                    <strong>Ù¾Ø§Ø±Ø³Ø§</strong>
                    <span>|</span>
                    <span>Ù†Ø³Ø®Ù‡ Û².Û°</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Transformer Calculator Page -->
    <div id="transformerPage" class="page">
        <div class="calc-container">
            <!-- Header -->
            <div class="calc-header blue">
                <button class="back-btn" onclick="backToWelcome()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                    </svg>
                    <span>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</span>
                </button>
                <h1>Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</h1>
                <p>Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¯Ù‚ÛŒÙ‚ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</p>
            </div>
            
            <!-- Calculator Grid -->
            <div class="calc-grid">
                <!-- Input Panel -->
                <div class="calc-panel">
                    <div class="panel-header blue">
                        <svg viewBox="0 0 24 24">
                            <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
                        </svg>
                        <h2>ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§</h2>
                    </div>
                    
                    <!-- Tabs -->
                    <div class="tabs blue">
                        <button class="tab active" onclick="switchTab('basic', 'transformer')">Ù¾Ø§ÛŒÙ‡</button>
                        <button class="tab" onclick="switchTab('advanced', 'transformer')">Ù¾ÛŒØ´Ø±ÙØªÙ‡</button>
                        <button class="tab" onclick="switchTab('core', 'transformer')">Ù‡Ø³ØªÙ‡</button>
                    </div>
                    
                    <!-- Basic Tab -->
                    <div id="transformer-basic-tab" class="tab-content active">
                        <div class="form-group">
                            <label>ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡ (V)</label>
                            <input type="number" id="primaryVoltage" value="220" min="1" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡ (V)</label>
                            <input type="number" id="secondaryVoltage" value="12" min="1" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ ÙˆØ±ÙˆØ¯ÛŒ:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="powerType" value="power" checked onchange="togglePowerType()">
                                    <span>ØªÙˆØ§Ù† (VA)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="powerType" value="current" onchange="togglePowerType()">
                                    <span>Ø¬Ø±ÛŒØ§Ù† (A)</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group" id="powerGroup">
                            <label>ØªÙˆØ§Ù† (VA)</label>
                            <input type="number" id="power" value="100" min="1" step="0.1">
                        </div>
                        <div class="form-group hidden" id="currentGroup">
                            <label>Ø¬Ø±ÛŒØ§Ù† (A)</label>
                            <input type="number" id="secondaryCurrent" value="8.33" min="0.1" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>ÙØ±Ú©Ø§Ù†Ø³ (Hz)</label>
                            <input type="number" id="frequency" value="50" min="1">
                        </div>
                    </div>
                    
                    <!-- Advanced Tab -->
                    <div id="transformer-advanced-tab" class="tab-content">
                        <div class="form-group">
                            <label>Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)</label>
                            <input type="number" id="fluxDensity" value="1.2" min="0.8" max="1.6" step="0.01">
                            <small>Ù…Ø¹Ù…ÙˆÙ„: 1.0 - 1.4 ØªØ³Ù„Ø§</small>
                        </div>
                        <div class="form-group">
                            <label>ØªØ¹ÛŒÛŒÙ† Ø³ÛŒÙ…:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="wireSpecType" value="currentDensity" checked onchange="toggleWireSpec()">
                                    <span>Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù†</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="wireSpecType" value="wireDiameter" onchange="toggleWireSpec()">
                                    <span>Ù‚Ø·Ø± Ø³ÛŒÙ…</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group" id="currentDensityGroup">
                            <label>Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)</label>
                            <input type="number" id="currentDensity" value="3" min="1" max="5" step="0.1">
                            <small>Ø§ÛŒÙ…Ù†: 2.5 - 3.5</small>
                        </div>
                        <div class="form-group hidden" id="wireDiameterGroup">
                            <label>Ù‚Ø·Ø± Ø³ÛŒÙ… Ø§ÙˆÙ„ÛŒÙ‡ (mm)</label>
                            <input type="number" id="primaryWireDiameter" value="0.5" min="0.1" max="5" step="0.01">
                            <label for="secondaryWireDiameter" style="margin-top: 1rem;">Ù‚Ø·Ø± Ø³ÛŒÙ… Ø«Ø§Ù†ÙˆÛŒÙ‡ (mm)</label>
                            <input type="number" id="secondaryWireDiameter" value="1.2" min="0.1" max="5" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Ø¬Ù†Ø³ Ø³ÛŒÙ…</label>
                            <select id="wireMaterial">
                                <option value="copper">Ù…Ø³</option>
                                <option value="aluminum">Ø¢Ù„ÙˆÙ…ÛŒÙ†ÛŒÙˆÙ…</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Core Tab -->
                    <div id="transformer-core-tab" class="tab-content">
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ù‡Ø³ØªÙ‡:</label>
                            <div class="core-type-selector">
                                <div class="core-option selected" data-type="EI" onclick="selectCoreType(this, 'EI')">EI</div>
                                <div class="core-option" data-type="UI" onclick="selectCoreType(this, 'UI')">UI</div>
                                <div class="core-option" data-type="Toroidal" onclick="selectCoreType(this, 'Toroidal')">ØªÙˆØ±ÙˆØ¦ÛŒØ¯</div>
                                <div class="core-option" data-type="C" onclick="selectCoreType(this, 'C')">C</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø§ÛŒØ² Ù‡Ø³ØªÙ‡</label>
                            <select id="coreSize">
                                <option value="EI-48">EI-48 (4.8cmÂ²)</option>
                                <option value="EI-54">EI-54 (5.4cmÂ²)</option>
                                <option value="EI-60" selected>EI-60 (6.0cmÂ²)</option>
                                <option value="EI-66">EI-66 (6.6cmÂ²)</option>
                                <option value="EI-75">EI-75 (7.5cmÂ²)</option>
                                <option value="EI-84">EI-84 (8.4cmÂ²)</option>
                                <option value="EI-96">EI-96 (9.6cmÂ²)</option>
                                <option value="EI-114">EI-114 (11.4cmÂ²)</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Calculate Button -->
                    <button class="calc-btn" onclick="calculateTransformer()">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M16 12l-4-4v8z" fill="white"/>
                        </svg>
                        <span id="transformerCalcBtnText">Ù…Ø­Ø§Ø³Ø¨Ù‡</span>
                    </button>
                    
                    <!-- Formula Box -->
                    <div class="formula-box">
                        <h3>
                            <svg viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4m0-4h.01" fill="white" stroke="white" stroke-width="2"/>
                            </svg>
                            <span>ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§:</span>
                        </h3>
                        <p>Nâ‚ = Vâ‚ / (4.44 Ã— f Ã— B Ã— A)</p>
                        <p>Nâ‚‚ = Vâ‚‚ / (4.44 Ã— f Ã— B Ã— A)</p>
                        <p>A = I / J</p>
                        <p>R = Ï Ã— L / A</p>
                    </div>
                </div>
                
                <!-- Results Panel -->
                <div class="calc-panel" style="max-height: none; overflow-y: visible;">
                    <div class="panel-header blue">
                        <svg viewBox="0 0 24 24">
                            <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
                        </svg>
                        <h2>Ù†ØªØ§ÛŒØ¬</h2>
                    </div>
                    <div id="transformerResults">
                        <div class="result-placeholder">
                            <div class="result-placeholder-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
                                </svg>
                            </div>
                            <p>Ù†ØªØ§ÛŒØ¬ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
                        </div>
                    </div>
                    <button class="export-btn hidden" id="transformerExportBtn" onclick="exportTransformerToExcel()">
                        <svg viewBox="0 0 24 24">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"/>
                            <path d="M14 2v6h6M12 18v-6M9 15l3 3 3-3"/>
                        </svg>
                        <span>Ø¯Ø§Ù†Ù„ÙˆØ¯ Excel</span>
                    </button>
                    <button class="export-btn hidden" id="transformerChartBtn" onclick="showTransformerChart()">
                        <svg viewBox="0 0 24 24">
                            <path d="M3 3v18h18"/>
                            <path d="M3 12l6-6 4 4 7-7"/>
                        </svg>
                        <span>Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø±</span>
                    </button>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="calc-footer">
                <div class="badge">
                    <span>Ø·Ø±Ø§Ø­ÛŒ ØªÙˆØ³Ø·</span>
                    <strong>Ù¾Ø§Ø±Ø³Ø§</strong>
                    <span>|</span>
                    <span>Ù†Ø³Ø®Ù‡ Û².Û°</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Motor Chart Modal -->
    <div id="motorChartModal" class="chart-modal">
        <div class="chart-container">
            <button class="close-chart" onclick="closeChart('motor')">Ã—</button>
            <h3 class="chart-title">ğŸ“ˆ Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ø´Ø®ØµÙ‡ Ú¯Ø´ØªØ§ÙˆØ±-Ø³Ø±Ø¹Øª Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±</h3>
            <div class="chart-wrapper">
                <canvas id="motorChart"></canvas>
            </div>
            <div class="chart-info">
                <h4>ğŸ“‹ Ù†Ú©Ø§Øª ÙÙ†ÛŒ:</h4>
                <ul>
                    <li>Ù†Ù‚Ø·Ù‡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ: Ø­Ø¯Ø§Ú©Ø«Ø± Ú¯Ø´ØªØ§ÙˆØ± Ø¯Ø± Ø³Ø±Ø¹Øª ØµÙØ±</li>
                    <li>Ú¯Ø´ØªØ§ÙˆØ± Ù†Ø§Ù…ÛŒ: Ø¯Ø± Ø³Ø±Ø¹Øª Ù†Ø§Ù…ÛŒ Ù…ÙˆØªÙˆØ±</li>
                    <li>Ú¯Ø´ØªØ§ÙˆØ± Ø´Ú©Ø³Øª: Ø­Ø¯Ø§Ú©Ø«Ø± Ú¯Ø´ØªØ§ÙˆØ± Ù‚Ø§Ø¨Ù„ ØªØ­Ù…Ù„</li>
                    <li>Ù…Ù†Ø·Ù‚Ù‡ Ú©Ø§Ø±Ú©Ø±Ø¯: Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø³Ø±Ø¹Øª Ø¹Ù…Ù„ÛŒØ§ØªÛŒ</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Transformer Chart Modal -->
    <div id="transformerChartModal" class="chart-modal">
        <div class="chart-container transformer">
            <button class="close-chart" onclick="closeChart('transformer')">Ã—</button>
            <h3 class="chart-title">ğŸ“Š Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ø´Ø®ØµÙ‡ ÙˆÙ„ØªØ§Ú˜-Ø¬Ø±ÛŒØ§Ù† ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</h3>
            <div class="chart-wrapper">
                <canvas id="transformerChart"></canvas>
            </div>
            <div class="chart-info">
                <h4>ğŸ“‹ Ù†Ú©Ø§Øª ÙÙ†ÛŒ:</h4>
                <ul>
                    <li>ÙˆÙ„ØªØ§Ú˜ Ø¨ÛŒâ€ŒØ¨Ø§Ø±ÛŒ: ÙˆÙ„ØªØ§Ú˜ Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ø¯ÙˆÙ† Ø¨Ø§Ø±</li>
                    <li>ØªÙ†Ø¸ÛŒÙ… ÙˆÙ„ØªØ§Ú˜: ØªØºÛŒÛŒØ±Ø§Øª ÙˆÙ„ØªØ§Ú˜ Ø§Ø² Ø¨ÛŒâ€ŒØ¨Ø§Ø±ÛŒ ØªØ§ Ø¨Ø§Ø± Ú©Ø§Ù…Ù„</li>
                    <li>Ø¨Ø§Ø²Ø¯Ù‡: Ù†Ø³Ø¨Øª ØªÙˆØ§Ù† Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ù‡ ÙˆØ±ÙˆØ¯ÛŒ</li>
                    <li>Ù…Ù†Ø·Ù‚Ù‡ Ø¨Ù‡ÛŒÙ†Ù‡: Ø¨Ø§Ø²Ø¯Ù‡ Ø­Ø¯Ø§Ú©Ø«Ø±ÛŒ</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ú¯Ù„ÙˆØ¨Ø§Ù„
        let selectedCoreType = 'EI';
        let motorCalculationData = null;
        let transformerCalculationData = null;
        let motorChartInstance = null;
        let transformerChartInstance = null;

        // ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª Ù…ØªØ­Ø±Ú©
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 40;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // ØªØ§Ø¨Ø¹ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨
        function selectCalculator(type) {
            document.getElementById('welcomePage').classList.remove('active');
            if (type === 'motor') {
                document.getElementById('motorPage').classList.add('active');
            } else {
                document.getElementById('transformerPage').classList.add('active');
            }
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
        function backToWelcome() {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById('welcomePage').classList.add('active');
        }

        // ØªØ§Ø¨Ø¹ ØªØ¹ÙˆÛŒØ¶ ØªØ¨â€ŒÙ‡Ø§
        function switchTab(tabName, pageType) {
            const prefix = pageType === 'motor' ? 'motor-' : 'transformer-';
            document.querySelectorAll(`#${pageType}Page .tab`).forEach(t => t.classList.remove('active'));
            document.querySelectorAll(`#${pageType}Page .tab-content`).forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(prefix + tabName + '-tab').classList.add('active');
        }

        // ØªØ§Ø¨Ø¹ ØªØºÛŒÛŒØ± Ù†ÙˆØ¹ ÙˆØ±ÙˆØ¯ÛŒ ØªÙˆØ§Ù†
        function togglePowerType() {
            const powerType = document.querySelector('input[name="powerType"]:checked').value;
            document.getElementById('powerGroup').classList.toggle('hidden', powerType !== 'power');
            document.getElementById('currentGroup').classList.toggle('hidden', powerType !== 'current');
        }

        // ØªØ§Ø¨Ø¹ ØªØºÛŒÛŒØ± Ù†ÙˆØ¹ Ù…Ø´Ø®ØµØ§Øª Ø³ÛŒÙ…
        function toggleWireSpec() {
            const wireSpecType = document.querySelector('input[name="wireSpecType"]:checked').value;
            document.getElementById('currentDensityGroup').classList.toggle('hidden', wireSpecType !== 'currentDensity');
            document.getElementById('wireDiameterGroup').classList.toggle('hidden', wireSpecType !== 'wireDiameter');
        }

        // ØªØ§Ø¨Ø¹ Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ù‡Ø³ØªÙ‡
        function selectCoreType(element, type) {
            document.querySelectorAll('.core-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedCoreType = type;
        }

        // ========== MOTOR CALCULATION ==========
        function calculateMotor() {
            const btn = document.getElementById('motorPage').querySelector('.calc-btn');
            const btnText = document.getElementById('motorCalcBtnText');
            btn.disabled = true;
            btnText.innerHTML = '<div class="loading-spinner"></div> Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡...';
            
            setTimeout(() => {
                // Ø¯Ø±ÛŒØ§ÙØª ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§
                const P_kW = parseFloat(document.getElementById('motorPower').value);
                const V_line = parseFloat(document.getElementById('motorVoltage').value);
                const I = parseFloat(document.getElementById('motorCurrent').value);
                const f = parseFloat(document.getElementById('motorFrequency').value);
                const Nr = parseFloat(document.getElementById('motorRPM').value);
                const Z = parseInt(document.getElementById('slotNumber').value);
                const m = 3;
                const P_poles = parseInt(document.getElementById('poleNumber').value);
                const windingType = document.querySelector('input[name="windingType"]:checked').value;
                const d_wire = parseFloat(document.getElementById('wireDiameterMotor').value);
                const connectionType = document.querySelector('input[name="connectionType"]:checked').value;
                const coreArea_cm2 = parseFloat(document.getElementById('coreArea').value);
                
                // Ù…Ø­Ø§Ø³Ø¨Ø§Øª
                const Ns = (120 * f) / P_poles;
                const S = ((Ns - Nr) / Ns * 100).toFixed(2);
                const YP = Z / (2 * P_poles);
                const q = Z / (2 * P_poles * m);
                const Î±e = (P_poles * 360) / Z;
                let YZ = Math.floor(YP);
                if (windingType === 'fractional') {
                    YZ = Math.floor(YP * 2 / 3);
                }
                
                const startPhase1 = 1;
                const startPhase2 = 1 + Math.round(120 / Î±e);
                const startPhase3 = 1 + Math.round(240 / Î±e);
                
                const B = 1.0;
                const kw = 0.92;
                const Ac = coreArea_cm2 / 10000;
                const V_ph = connectionType === 'star' ? V_line / Math.sqrt(3) : V_line;
                const N_phase = V_ph / (4.44 * f * kw * B * Ac);
                const coilsPerPhase = Z / (2 * m);
                const turnsPerCoil = Math.max(1, Math.round(N_phase / coilsPerPhase));
                const A_wire = (Math.PI * d_wire ** 2) / 4;
                const J = I / A_wire;
                const slotPitch = 0.015;
                const coilLength_m = YZ * slotPitch;
                const wireLengthPerCoil = 2 * turnsPerCoil * (coilLength_m + 0.1);
                const totalCoils = Z / 2;
                const totalWireLength = (wireLengthPerCoil * totalCoils).toFixed(2);
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„
                motorCalculationData = {
                    inputs: {
                        'ØªÙˆØ§Ù† (kW)': P_kW,
                        'ÙˆÙ„ØªØ§Ú˜ (V)': V_line,
                        'Ø¬Ø±ÛŒØ§Ù† (A)': I,
                        'ÙØ±Ú©Ø§Ù†Ø³ (Hz)': f,
                        'Ø³Ø±Ø¹Øª (RPM)': Nr,
                        'Ø´ÛŒØ§Ø± (Z)': Z,
                        'Ù‚Ø·Ø¨ (P)': P_poles,
                        'Ù†ÙˆØ¹ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ': windingType === 'full' ? 'Ú¯Ø§Ù… Ú©Ø§Ù…Ù„' : 'Ú¯Ø§Ù… Ú©Ø³Ø±ÛŒ',
                        'Ù‚Ø·Ø± Ø³ÛŒÙ… (mm)': d_wire,
                        'Ø§ØªØµØ§Ù„': connectionType === 'star' ? 'Ø³ØªØ§Ø±Ù‡' : 'Ù…Ø«Ù„Ø«',
                        'Ù‡Ø³ØªÙ‡ (cmÂ²)': coreArea_cm2
                    },
                    results: {
                        'Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ† (RPM)': Ns.toFixed(0),
                        'Ù„ØºØ²Ø´ (%)': S,
                        'Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ': YP.toFixed(2),
                        'q': q.toFixed(2),
                        'Ø²Ø§ÙˆÛŒÙ‡ (Â°)': Î±e.toFixed(2),
                        'Ú¯Ø§Ù… Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ': YZ,
                        'ÙˆÙ„ØªØ§Ú˜ ÙØ§Ø² (V)': V_ph.toFixed(2),
                        'Ø¯ÙˆØ± ÙØ§Ø²': N_phase.toFixed(0),
                        'Ø¯ÙˆØ± Ú©Ø§Ù„Ù': turnsPerCoil,
                        'Ø³Ø·Ø­ Ø³ÛŒÙ… (mmÂ²)': A_wire.toFixed(3),
                        'Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)': J.toFixed(2),
                        'Ø·ÙˆÙ„ Ø³ÛŒÙ… (m)': totalWireLength,
                        'ÙØ§Ø² U': startPhase1,
                        'ÙØ§Ø² V': startPhase2,
                        'ÙØ§Ø² W': startPhase3
                    }
                };
                
                // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
                const warnings = [];
                const successes = [];
                if (q < 1) warnings.push(`q Ú©ÙˆÚ†Ú© (${q.toFixed(2)})`);
                if (q > 4) warnings.push(`q Ø¨Ø²Ø±Ú¯ (${q.toFixed(2)})`);
                if (YZ < 1) warnings.push("Ú¯Ø§Ù… Ú©ÙˆÚ†Ú©");
                if (J > 3.5) warnings.push(`Ú†Ú¯Ø§Ù„ÛŒ Ø¨Ø§Ù„Ø§ (${J.toFixed(2)})`);
                if (parseFloat(S) > 8) warnings.push(`Ù„ØºØ²Ø´ Ø¨Ø§Ù„Ø§ (${S}%)`);
                if (q >= 1 && q <= 4) successes.push("q Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯");
                if (J <= 3.0) successes.push("Ú†Ú¯Ø§Ù„ÛŒ Ø§ÛŒÙ…Ù†");
                if (parseFloat(S) <= 5) successes.push("Ù„ØºØ²Ø´ Ù¾Ø§ÛŒÛŒÙ†");
                
                // Ø³Ø§Ø®Øª HTML Ù†ØªØ§ÛŒØ¬
                let html = `
                    <div class="result-section">
                        <h3>âš™ï¸ Ù…Ø´Ø®ØµØ§Øª Ú©Ù„ÛŒ</h3>
                        <div class="result-item highlight">
                            <span class="result-label">ØªÙˆØ§Ù†:</span>
                            <span class="result-value">${P_kW} kW</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ÙˆÙ„ØªØ§Ú˜:</span>
                            <span class="result-value">${V_line} V</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø¬Ø±ÛŒØ§Ù†:</span>
                            <span class="result-value">${I} A</span>
                        </div>
                        <div class="result-item highlight">
                            <span class="result-label">Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ†:</span>
                            <span class="result-value">${Ns.toFixed(0)} RPM</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ù„ØºØ²Ø´:</span>
                            <span class="result-value">${S}%</span>
                        </div>
                    </div>
                    <div class="result-section">
                        <h3>ğŸŒ€ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ</h3>
                        <div class="result-item">
                            <span class="result-label">Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ:</span>
                            <span class="result-value">${YP.toFixed(2)}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">q:</span>
                            <span class="result-value">${q.toFixed(2)}</span>
                        </div>
                        <div class="result-item highlight">
                            <span class="result-label">Ú¯Ø§Ù…:</span>
                            <span class="result-value">${YZ}</span>
                        </div>
                        <div class="result-item highlight">
                            <span class="result-label">Ø¯ÙˆØ± Ú©Ø§Ù„Ù:</span>
                            <span class="result-value">${turnsPerCoil}</span>
                        </div>
                        <div class="result-item highlight">
                            <span class="result-label">Ø·ÙˆÙ„ Ø³ÛŒÙ…:</span>
                            <span class="result-value">${totalWireLength} m</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù†:</span>
                            <span class="result-value">${J.toFixed(2)} A/mmÂ²</span>
                        </div>
                    </div>
                    <div class="result-section">
                        <h3>ğŸ”Œ ÙØ§Ø²Ù‡Ø§</h3>
                        <div class="result-item">
                            <span class="result-label">U:</span>
                            <span class="result-value">${startPhase1}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">V:</span>
                            <span class="result-value">${startPhase2}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">W:</span>
                            <span class="result-value">${startPhase3}</span>
                        </div>
                    </div>
                `;
                
                if (warnings.length > 0) {
                    html += `
                        <div class="warning-box">
                            <h4>
                                <svg viewBox="0 0 24 24"><path d="M12 2L1 21h22L12 2zm0 6l1 7h-2l1-7zm0 10a1 1 0 100 2 1 1 0 000-2z"/></svg>
                                Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§:
                            </h4>
                            <ul>${warnings.map(w => `<li>${w}</li>`).join('')}</ul>
                        </div>
                    `;
                }
                
                if (successes.length > 0) {
                    html += `
                        <div class="success-box">
                            <h4>
                                <svg viewBox="0 0 24 24"><path d="M12 2a10 10 0 110 20 10 10 0 010-20zm-2 13l-3-3 1.5-1.5L10 12l5.5-5.5L17 8l-7 7z"/></svg>
                                ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§:
                            </h4>
                            <ul>${successes.map(s => `<li>${s}</li>`).join('')}</ul>
                        </div>
                    `;
                }
                
                document.getElementById('motorResults').innerHTML = html;
                document.getElementById('motorExportBtn').classList.remove('hidden');
                document.getElementById('motorChartBtn').classList.remove('hidden');
                
                btn.disabled = false;
                btnText.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24" fill="white"><circle cx="12" cy="12" r="10"/><path d="M16 12l-4-4v8z" fill="white"/></svg> Ù…Ø­Ø§Ø³Ø¨Ù‡';
            }, 600);
        }

        // ========== TRANSFORMER CALCULATION ==========
        function calculateTransformer() {
            const btn = document.getElementById('transformerPage').querySelector('.calc-btn');
            const btnText = document.getElementById('transformerCalcBtnText');
            btn.disabled = true;
            btnText.innerHTML = '<div class="loading-spinner"></div> Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡...';
            
            setTimeout(() => {
                const V1 = parseFloat(document.getElementById('primaryVoltage').value);
                const V2 = parseFloat(document.getElementById('secondaryVoltage').value);
                const f = parseFloat(document.getElementById('frequency').value);
                const Bmax = parseFloat(document.getElementById('fluxDensity').value);
                const wireMaterial = document.getElementById('wireMaterial').value;
                const coreSize = document.getElementById('coreSize').value;
                
                let P, I2;
                const powerType = document.querySelector('input[name="powerType"]:checked').value;
                if (powerType === 'power') {
                    P = parseFloat(document.getElementById('power').value);
                    I2 = P / V2;
                } else {
                    I2 = parseFloat(document.getElementById('secondaryCurrent').value);
                    P = V2 * I2;
                }
                
                const Ï = wireMaterial === 'copper' ? 0.0175 : 0.0283;
                const coreSizeMap = {
                    'EI-48': 4.8, 'EI-54': 5.4, 'EI-60': 6.0, 'EI-66': 6.6,
                    'EI-75': 7.5, 'EI-84': 8.4, 'EI-96': 9.6, 'EI-114': 11.4
                };
                const Acore_cm2 = coreSizeMap[coreSize] || 6.0;
                const Acore = Acore_cm2 / 10000 * 0.95;
                
                const N1 = Math.round(V1 / (4.44 * f * Bmax * Acore));
                const N2 = Math.round(V2 / (4.44 * f * Bmax * Acore));
                const I1 = P / (V1 * 0.95);
                
                let A1, A2, d1, d2;
                const wireSpecType = document.querySelector('input[name="wireSpecType"]:checked').value;
                if (wireSpecType === 'currentDensity') {
                    const J = parseFloat(document.getElementById('currentDensity').value);
                    A1 = I1 / J;
                    A2 = I2 / J;
                    d1 = Math.sqrt((4 * A1) / Math.PI);
                    d2 = Math.sqrt((4 * A2) / Math.PI);
                } else {
                    d1 = parseFloat(document.getElementById('primaryWireDiameter').value);
                    d2 = parseFloat(document.getElementById('secondaryWireDiameter').value);
                    A1 = (Math.PI * d1 * d1) / 4;
                    A2 = (Math.PI * d2 * d2) / 4;
                }
                
                const coreTypeMLT = {
                    'EI': 10 + Acore_cm2 * 0.5,
                    'UI': 12 + Acore_cm2 * 0.6,
                    'Toroidal': 8 + Acore_cm2 * 0.4,
                    'C': 11 + Acore_cm2 * 0.55
                };
                const MLT = (coreTypeMLT[selectedCoreType] || 10) / 100;
                const L1 = (N1 * MLT).toFixed(2);
                const L2 = (N2 * MLT).toFixed(2);
                const R1 = (Ï * N1 * MLT / A1).toFixed(3);
                const R2 = (Ï * N2 * MLT / A2).toFixed(3);
                const Pcu1 = (I1 * I1 * Ï * N1 * MLT / A1).toFixed(2);
                const Pcu2 = (I2 * I2 * Ï * N2 * MLT / A2).toFixed(2);
                const Pcu_total = (parseFloat(Pcu1) + parseFloat(Pcu2)).toFixed(2);
                const Pfe = (2.5 * Acore_cm2 * 0.1).toFixed(2);
                const P_total = (parseFloat(Pcu_total) + parseFloat(Pfe)).toFixed(2);
                const efficiency = ((P / (P + parseFloat(P_total))) * 100).toFixed(2);
                const powerDensity = (P / Acore_cm2).toFixed(2);
                const J1_real = (I1 / A1).toFixed(2);
                const J2_real = (I2 / A2).toFixed(2);
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„
                transformerCalculationData = {
                    inputs: {
                        'ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡ (V)': V1,
                        'ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡ (V)': V2,
                        'ØªÙˆØ§Ù† (VA)': P,
                        'ÙØ±Ú©Ø§Ù†Ø³ (Hz)': f,
                        'Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)': Bmax,
                        'Ù‡Ø³ØªÙ‡': selectedCoreType,
                        'Ø³Ø§ÛŒØ²': coreSize,
                        'Ø³Ø·Ø­ (cmÂ²)': Acore_cm2,
                        'Ø¬Ù†Ø³': wireMaterial === 'copper' ? 'Ù…Ø³' : 'Ø¢Ù„ÙˆÙ…ÛŒÙ†ÛŒÙˆÙ…'
                    },
                    results: {
                        'Ø¯ÙˆØ± Ø§ÙˆÙ„ÛŒÙ‡': N1,
                        'Ø¯ÙˆØ± Ø«Ø§Ù†ÙˆÛŒÙ‡': N2,
                        'Ù†Ø³Ø¨Øª': (V1/V2).toFixed(2),
                        'Ø¬Ø±ÛŒØ§Ù† Ø§ÙˆÙ„ÛŒÙ‡ (A)': I1.toFixed(3),
                        'Ø¬Ø±ÛŒØ§Ù† Ø«Ø§Ù†ÙˆÛŒÙ‡ (A)': I2.toFixed(3),
                        'Ù‚Ø·Ø± Ø§ÙˆÙ„ÛŒÙ‡ (mm)': d1.toFixed(2),
                        'Ù‚Ø·Ø± Ø«Ø§Ù†ÙˆÛŒÙ‡ (mm)': d2.toFixed(2),
                        'J Ø§ÙˆÙ„ÛŒÙ‡ (A/mmÂ²)': J1_real,
                        'J Ø«Ø§Ù†ÙˆÛŒÙ‡ (A/mmÂ²)': J2_real,
                        'Ø·ÙˆÙ„ Ø§ÙˆÙ„ÛŒÙ‡ (m)': L1,
                        'Ø·ÙˆÙ„ Ø«Ø§Ù†ÙˆÛŒÙ‡ (m)': L2,
                        'R Ø§ÙˆÙ„ÛŒÙ‡ (Î©)': R1,
                        'R Ø«Ø§Ù†ÙˆÛŒÙ‡ (Î©)': R2,
                        'ØªÙ„ÙØ§Øª Ù…Ø³ (W)': Pcu_total,
                        'ØªÙ„ÙØ§Øª Ù‡Ø³ØªÙ‡ (W)': Pfe,
                        'Ú©Ù„ ØªÙ„ÙØ§Øª (W)': P_total,
                        'Ø¨Ø§Ø²Ø¯Ù‡ (%)': efficiency
                    }
                };
                
                const warnings = [];
                const successes = [];
                if (Bmax > 1.4) warnings.push("Ø´Ø§Ø± Ø¨Ø§Ù„Ø§");
                if (J1_real > 3.5 || J2_real > 3.5) warnings.push("Ú†Ú¯Ø§Ù„ÛŒ Ø¨Ø§Ù„Ø§");
                if (efficiency < 85) warnings.push(`Ø¨Ø§Ø²Ø¯Ù‡ Ù¾Ø§ÛŒÛŒÙ† (${efficiency}%)`);
                if (powerDensity > 2) warnings.push("ØªÙˆØ§Ù† Ø¨Ø§Ù„Ø§");
                if (Bmax <= 1.2 && Bmax >= 0.9) successes.push("Ø´Ø§Ø± Ø¨Ù‡ÛŒÙ†Ù‡");
                if (J1_real <= 3 && J2_real <= 3) successes.push("Ú†Ú¯Ø§Ù„ÛŒ Ø§ÛŒÙ…Ù†");
                if (efficiency > 92) successes.push("Ø¨Ø§Ø²Ø¯Ù‡ Ø¹Ø§Ù„ÛŒ");
                if (parseFloat(powerDensity) < 1.5) successes.push("ØªÙˆØ§Ù† Ù…Ù†Ø§Ø³Ø¨");
                
                let html = `
                    <div class="result-section">
                        <h3>ğŸ§² Ù‡Ø³ØªÙ‡</h3>
                        <div class="result-item"><span class="result-label">Ù†ÙˆØ¹:</span><span class="result-value">${selectedCoreType}</span></div>
                        <div class="result-item"><span class="result-label">Ø³Ø§ÛŒØ²:</span><span class="result-value">${coreSize}</span></div>
                        <div class="result-item highlight"><span class="result-label">ØªÙˆØ§Ù†:</span><span class="result-value">${P} VA</span></div>
                    </div>
                    <div class="result-section">
                        <h3>âš¡ Ø§Ù„Ú©ØªØ±ÛŒÚ©ÛŒ</h3>
                        <div class="result-item highlight"><span class="result-label">Nâ‚:</span><span class="result-value">${N1}</span></div>
                        <div class="result-item highlight"><span class="result-label">Nâ‚‚:</span><span class="result-value">${N2}</span></div>
                        <div class="result-item"><span class="result-label">Ù†Ø³Ø¨Øª:</span><span class="result-value">${(V1/V2).toFixed(2)}</span></div>
                        <div class="result-item highlight"><span class="result-label">Ø¨Ø§Ø²Ø¯Ù‡:</span><span class="result-value">${efficiency}%</span></div>
                    </div>
                    <div class="result-section">
                        <h3>ğŸŒ€ Ø³ÛŒÙ…â€ŒÙ‡Ø§</h3>
                        <div class="result-item"><span class="result-label">dâ‚:</span><span class="result-value">${d1.toFixed(2)} mm</span></div>
                        <div class="result-item"><span class="result-label">dâ‚‚:</span><span class="result-value">${d2.toFixed(2)} mm</span></div>
                        <div class="result-item"><span class="result-label">Lâ‚:</span><span class="result-value">${L1} m</span></div>
                        <div class="result-item"><span class="result-label">Lâ‚‚:</span><span class="result-value">${L2} m</span></div>
                    </div>
                    <div class="result-section">
                        <h3>ğŸ”¥ ØªÙ„ÙØ§Øª</h3>
                        <div class="result-item"><span class="result-label">Ù…Ø³:</span><span class="result-value">${Pcu_total} W</span></div>
                        <div class="result-item"><span class="result-label">Ù‡Ø³ØªÙ‡:</span><span class="result-value">${Pfe} W</span></div>
                        <div class="result-item highlight"><span class="result-label">Ú©Ù„:</span><span class="result-value">${P_total} W</span></div>
                    </div>
                `;
                
                if (warnings.length > 0) {
                    html += `<div class="warning-box"><h4>âš ï¸ Ù‡Ø´Ø¯Ø§Ø±:</h4><ul>${warnings.map(w => `<li>${w}</li>`).join('')}</ul></div>`;
                }
                if (successes.length > 0) {
                    html += `<div class="success-box"><h4>âœ… ØªØ£ÛŒÛŒØ¯:</h4><ul>${successes.map(s => `<li>${s}</li>`).join('')}</ul></div>`;
                }
                
                document.getElementById('transformerResults').innerHTML = html;
                document.getElementById('transformerExportBtn').classList.remove('hidden');
                document.getElementById('transformerChartBtn').classList.remove('hidden');
                
                btn.disabled = false;
                btnText.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24" fill="white"><circle cx="12" cy="12" r="10"/><path d="M16 12l-4-4v8z" fill="white"/></svg> Ù…Ø­Ø§Ø³Ø¨Ù‡';
            }, 600);
        }

        // ========== EXCEL EXPORT FUNCTIONS ==========
        function exportMotorToExcel() {
            if (!motorCalculationData) return;
            
            const wb = XLSX.utils.book_new();
            
            // Ø³Ø§Ø®ØªØ§Ø± Ø¯Ù‚ÛŒÙ‚ Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§ ÙØ§ÛŒÙ„ Ù†Ù…ÙˆÙ†Ù‡
            const data = [
                ['Ù†ØªÛŒØ¬Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª'],
                ['ØªÙˆØ§Ù†:'],
                ['ÙˆÙ„ØªØ§Ú˜:'],
                ['Ø¬Ø±ÛŒØ§Ù†:'],
                ['Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ†:'],
                ['Ù„ØºØ²Ø´:'],
                [''],
                ['ğŸŒ€ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ'],
                ['Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ:'],
                ['q:'],
                ['Ú¯Ø§Ù…:'],
                ['Ø¯ÙˆØ± Ú©Ø§Ù„Ù:'],
                ['Ø·ÙˆÙ„ Ø³ÛŒÙ…:'],
                ['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù†:'],
                [''],
                ['ğŸ”Œ ÙØ§Ø²Ù‡Ø§'],
                [''],
                ['U:'],
                ['V:'],
                ['W:'],
                [''],
                ['Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§:'],
                [''],
                [''],
                [''],
                ['ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§:']
            ];
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù…Ù‚Ø§Ø¯ÛŒØ±
            const results = motorCalculationData.results;
            
            // Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù†ØªÛŒØ¬Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª
            data[1][0] = `ØªÙˆØ§Ù†: ${motorCalculationData.inputs['ØªÙˆØ§Ù† (kW)']} kW`;
            data[2][0] = `ÙˆÙ„ØªØ§Ú˜: ${motorCalculationData.inputs['ÙˆÙ„ØªØ§Ú˜ (V)']} V`;
            data[3][0] = `Ø¬Ø±ÛŒØ§Ù†: ${motorCalculationData.inputs['Ø¬Ø±ÛŒØ§Ù† (A)']} A`;
            data[4][0] = `Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ†: ${results['Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ† (RPM)']} RPM`;
            data[5][0] = `Ù„ØºØ²Ø´: ${results['Ù„ØºØ²Ø´ (%)']}%`;
            
            // Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ
            data[8][0] = `Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ: ${results['Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ']}`;
            data[9][0] = `q: ${results['q']}`;
            data[10][0] = `Ú¯Ø§Ù…: ${results['Ú¯Ø§Ù… Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ']}`;
            data[11][0] = `Ø¯ÙˆØ± Ú©Ø§Ù„Ù: ${results['Ø¯ÙˆØ± Ú©Ø§Ù„Ù']}`;
            data[12][0] = `Ø·ÙˆÙ„ Ø³ÛŒÙ…: ${results['Ø·ÙˆÙ„ Ø³ÛŒÙ… (m)']} m`;
            data[13][0] = `Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù†: ${results['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)']} A/mmÂ²`;
            
            // Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ ÙØ§Ø²Ù‡Ø§
            data[16][0] = `U: ${results['ÙØ§Ø² U']}`;
            data[17][0] = `V: ${results['ÙØ§Ø² V']}`;
            data[18][0] = `W: ${results['ÙØ§Ø² W']}`;
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ùˆ ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§ (Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…ÙˆØ¬ÙˆØ¯)
            const warnings = [];
            const successes = [];
            
            // Ù…Ù†Ø·Ù‚ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ù…Ø´Ø§Ø¨Ù‡ Ø¨Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± ØµÙØ­Ù‡
            if (parseFloat(results['q']) < 1) warnings.push(`q Ú©ÙˆÚ†Ú© (${results['q']})`);
            if (parseFloat(results['q']) > 4) warnings.push(`q Ø¨Ø²Ø±Ú¯ (${results['q']})`);
            if (parseFloat(results['Ú¯Ø§Ù… Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ']) < 1) warnings.push("Ú¯Ø§Ù… Ú©ÙˆÚ†Ú©");
            if (parseFloat(results['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)']) > 3.5) warnings.push(`Ú†Ú¯Ø§Ù„ÛŒ Ø¨Ø§Ù„Ø§ (${results['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)']})`);
            if (parseFloat(results['Ù„ØºØ²Ø´ (%)']) > 8) warnings.push(`Ù„ØºØ²Ø´ Ø¨Ø§Ù„Ø§ (${results['Ù„ØºØ²Ø´ (%)']}%)`);
            
            if (parseFloat(results['q']) >= 1 && parseFloat(results['q']) <= 4) successes.push("q Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯");
            if (parseFloat(results['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)']) <= 3.0) successes.push("Ú†Ú¯Ø§Ù„ÛŒ Ø§ÛŒÙ…Ù†");
            if (parseFloat(results['Ù„ØºØ²Ø´ (%)']) <= 5) successes.push("Ù„ØºØ²Ø´ Ù¾Ø§ÛŒÛŒÙ†");
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§
            if (warnings.length > 0) {
                data[20][0] = 'Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§:';
                warnings.forEach((warning, index) => {
                    if (21 + index < data.length) {
                        data[21 + index][0] = `â€¢ ${warning}`;
                    }
                });
            }
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§
            const successStartIndex = 20 + warnings.length + 2;
            if (successes.length > 0) {
                data[successStartIndex][0] = 'ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§:';
                successes.forEach((success, index) => {
                    if (successStartIndex + 1 + index < data.length) {
                        data[successStartIndex + 1 + index][0] = `â€¢ ${success}`;
                    }
                });
            }
            
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // ØªÙ†Ø¸ÛŒÙ… Ø¹Ø±Ø¶ Ø³ØªÙˆÙ†
            const wscols = [{ wch: 40 }]; // Ø¹Ø±Ø¶ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø³ØªÙˆÙ† ÙØ§Ø±Ø³ÛŒ
            ws['!cols'] = wscols;
            
            XLSX.utils.book_append_sheet(wb, ws, 'ÙˆØ±Ù‚Ù‡1');
            
            // Ø¯Ø§Ù†Ù„ÙˆØ¯
            XLSX.writeFile(wb, `Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±_${new Date().toISOString().split('T')[0]}.xlsx`);
        }

        function exportTransformerToExcel() {
            if (!transformerCalculationData) return;
            
            const wb = XLSX.utils.book_new();
            
            // Ø³Ø§Ø®ØªØ§Ø± Ù…Ø´Ø§Ø¨Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ± (Ø¨Ø§ ØªØºÛŒÛŒØ±Ø§Øª Ù…Ù†Ø§Ø³Ø¨)
            const data = [
                ['Ù†ØªÛŒØ¬Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª'],
                ['Ù†ÙˆØ¹ Ù‡Ø³ØªÙ‡:'],
                ['ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡:'],
                ['ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡:'],
                ['ØªÙˆØ§Ù†:'],
                [''],
                ['âš¡ Ø§Ù„Ú©ØªØ±ÛŒÚ©ÛŒ'],
                ['Ø¯ÙˆØ± Ø§ÙˆÙ„ÛŒÙ‡:'],
                ['Ø¯ÙˆØ± Ø«Ø§Ù†ÙˆÛŒÙ‡:'],
                ['Ù†Ø³Ø¨Øª:'],
                ['Ø¨Ø§Ø²Ø¯Ù‡:'],
                [''],
                ['ğŸŒ€ Ø³ÛŒÙ…â€ŒÙ‡Ø§'],
                ['Ù‚Ø·Ø± Ø§ÙˆÙ„ÛŒÙ‡:'],
                ['Ù‚Ø·Ø± Ø«Ø§Ù†ÙˆÛŒÙ‡:'],
                ['Ø·ÙˆÙ„ Ø§ÙˆÙ„ÛŒÙ‡:'],
                ['Ø·ÙˆÙ„ Ø«Ø§Ù†ÙˆÛŒÙ‡:'],
                [''],
                ['ğŸ”¥ ØªÙ„ÙØ§Øª'],
                ['ØªÙ„ÙØ§Øª Ù…Ø³:'],
                ['ØªÙ„ÙØ§Øª Ù‡Ø³ØªÙ‡:'],
                ['Ú©Ù„ ØªÙ„ÙØ§Øª:'],
                [''],
                ['Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§:'],
                [''],
                [''],
                [''],
                ['ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§:']
            ];
            
            const inputs = transformerCalculationData.inputs;
            const results = transformerCalculationData.results;
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù…Ù‚Ø§Ø¯ÛŒØ±
            data[1][0] = `Ù†ÙˆØ¹ Ù‡Ø³ØªÙ‡: ${inputs['Ù‡Ø³ØªÙ‡']} (${inputs['Ø³Ø§ÛŒØ²']})`;
            data[2][0] = `ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡: ${inputs['ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡ (V)']} V`;
            data[3][0] = `ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡: ${inputs['ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡ (V)']} V`;
            data[4][0] = `ØªÙˆØ§Ù†: ${inputs['ØªÙˆØ§Ù† (VA)']} VA`;
            
            data[7][0] = `Ø¯ÙˆØ± Ø§ÙˆÙ„ÛŒÙ‡: ${results['Ø¯ÙˆØ± Ø§ÙˆÙ„ÛŒÙ‡']}`;
            data[8][0] = `Ø¯ÙˆØ± Ø«Ø§Ù†ÙˆÛŒÙ‡: ${results['Ø¯ÙˆØ± Ø«Ø§Ù†ÙˆÛŒÙ‡']}`;
            data[9][0] = `Ù†Ø³Ø¨Øª: ${results['Ù†Ø³Ø¨Øª']}`;
            data[10][0] = `Ø¨Ø§Ø²Ø¯Ù‡: ${results['Ø¨Ø§Ø²Ø¯Ù‡ (%)']}%`;
            
            data[13][0] = `Ù‚Ø·Ø± Ø§ÙˆÙ„ÛŒÙ‡: ${results['Ù‚Ø·Ø± Ø§ÙˆÙ„ÛŒÙ‡ (mm)']} mm`;
            data[14][0] = `Ù‚Ø·Ø± Ø«Ø§Ù†ÙˆÛŒÙ‡: ${results['Ù‚Ø·Ø± Ø«Ø§Ù†ÙˆÛŒÙ‡ (mm)']} mm`;
            data[15][0] = `Ø·ÙˆÙ„ Ø§ÙˆÙ„ÛŒÙ‡: ${results['Ø·ÙˆÙ„ Ø§ÙˆÙ„ÛŒÙ‡ (m)']} m`;
            data[16][0] = `Ø·ÙˆÙ„ Ø«Ø§Ù†ÙˆÛŒÙ‡: ${results['Ø·ÙˆÙ„ Ø«Ø§Ù†ÙˆÛŒÙ‡ (m)']} m`;
            
            data[19][0] = `ØªÙ„ÙØ§Øª Ù…Ø³: ${results['ØªÙ„ÙØ§Øª Ù…Ø³ (W)']} W`;
            data[20][0] = `ØªÙ„ÙØ§Øª Ù‡Ø³ØªÙ‡: ${results['ØªÙ„ÙØ§Øª Ù‡Ø³ØªÙ‡ (W)']} W`;
            data[21][0] = `Ú©Ù„ ØªÙ„ÙØ§Øª: ${results['Ú©Ù„ ØªÙ„ÙØ§Øª (W)']} W`;
            
            // Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ùˆ ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§
            const warnings = [];
            const successes = [];
            
            if (parseFloat(inputs['Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)']) > 1.4) warnings.push("Ø´Ø§Ø± Ø¨Ø§Ù„Ø§");
            if (parseFloat(results['J Ø§ÙˆÙ„ÛŒÙ‡ (A/mmÂ²)']) > 3.5 || parseFloat(results['J Ø«Ø§Ù†ÙˆÛŒÙ‡ (A/mmÂ²)']) > 3.5) warnings.push("Ú†Ú¯Ø§Ù„ÛŒ Ø¨Ø§Ù„Ø§");
            if (parseFloat(results['Ø¨Ø§Ø²Ø¯Ù‡ (%)']) < 85) warnings.push(`Ø¨Ø§Ø²Ø¯Ù‡ Ù¾Ø§ÛŒÛŒÙ† (${results['Ø¨Ø§Ø²Ø¯Ù‡ (%)']}%)`);
            
            if (parseFloat(inputs['Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)']) <= 1.2 && parseFloat(inputs['Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)']) >= 0.9) successes.push("Ø´Ø§Ø± Ø¨Ù‡ÛŒÙ†Ù‡");
            if (parseFloat(results['J Ø§ÙˆÙ„ÛŒÙ‡ (A/mmÂ²)']) <= 3 && parseFloat(results['J Ø«Ø§Ù†ÙˆÛŒÙ‡ (A/mmÂ²)']) <= 3) successes.push("Ú†Ú¯Ø§Ù„ÛŒ Ø§ÛŒÙ…Ù†");
            if (parseFloat(results['Ø¨Ø§Ø²Ø¯Ù‡ (%)']) > 92) successes.push("Ø¨Ø§Ø²Ø¯Ù‡ Ø¹Ø§Ù„ÛŒ");
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§
            if (warnings.length > 0) {
                data[23][0] = 'Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§:';
                warnings.forEach((warning, index) => {
                    if (24 + index < data.length) {
                        data[24 + index][0] = `â€¢ ${warning}`;
                    }
                });
            }
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§
            const successStartIndex = 23 + warnings.length + 2;
            if (successes.length > 0) {
                data[successStartIndex][0] = 'ØªØ£ÛŒÛŒØ¯ÛŒÙ‡â€ŒÙ‡Ø§:';
                successes.forEach((success, index) => {
                    if (successStartIndex + 1 + index < data.length) {
                        data[successStartIndex + 1 + index][0] = `â€¢ ${success}`;
                    }
                });
            }
            
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // ØªÙ†Ø¸ÛŒÙ… Ø¹Ø±Ø¶ Ø³ØªÙˆÙ†
            const wscols = [{ wch: 40 }];
            ws['!cols'] = wscols;
            
            XLSX.utils.book_append_sheet(wb, ws, 'ÙˆØ±Ù‚Ù‡1');
            
            // Ø¯Ø§Ù†Ù„ÙˆØ¯
            XLSX.writeFile(wb, `ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±_${new Date().toISOString().split('T')[0]}.xlsx`);
        }

        // ========== CHART FUNCTIONS ==========

        // Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø± Ù…ÙˆØªÙˆØ±
        function showMotorChart() {
            if (!motorCalculationData) return;
            
            // Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¨Ø±Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
            const inputs = motorCalculationData.inputs;
            const results = motorCalculationData.results;
            
            const Ns = parseFloat(results['Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ† (RPM)']);
            const Nr = parseFloat(inputs['Ø³Ø±Ø¹Øª (RPM)']);
            const P_kW = parseFloat(inputs['ØªÙˆØ§Ù† (kW)']);
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú¯Ø´ØªØ§ÙˆØ±Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
            const T_rated = (P_kW * 9550) / Nr; // Ú¯Ø´ØªØ§ÙˆØ± Ù†Ø§Ù…ÛŒ (Nm)
            const T_start = T_rated * 2.5; // Ú¯Ø´ØªØ§ÙˆØ± Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 2.5 Ø¨Ø±Ø§Ø¨Ø±)
            const T_breakdown = T_rated * 3.0; // Ú¯Ø´ØªØ§ÙˆØ± Ø´Ú©Ø³Øª (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 3 Ø¨Ø±Ø§Ø¨Ø±)
            const T_pullup = T_rated * 2.0; // Ú¯Ø´ØªØ§ÙˆØ± Ú©Ø´Ø´ÛŒ
            
            // ØªÙˆÙ„ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
            const speeds = [];
            const torques = [];
            
            // ØªÙˆÙ„ÛŒØ¯ 50 Ù†Ù‚Ø·Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ù†Ø­Ù†ÛŒ
            for (let i = 0; i <= 50; i++) {
                const speed = (i / 50) * Ns;
                speeds.push(speed);
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú¯Ø´ØªØ§ÙˆØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø±Ø¹Øª (Ù…Ù†Ø­Ù†ÛŒ ØªÙ‚Ø±ÛŒØ¨ÛŒ Ù…ÙˆØªÙˆØ± Ø§Ù„Ù‚Ø§ÛŒÛŒ)
                let torque;
                if (speed === 0) {
                    torque = T_start;
                } else if (speed < 0.2 * Ns) {
                    // Ù…Ù†Ø·Ù‚Ù‡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ
                    torque = T_start - (T_start - T_pullup) * (speed / (0.2 * Ns));
                } else if (speed < 0.8 * Ns) {
                    // Ù…Ù†Ø·Ù‚Ù‡ Ú©Ø´Ø´ÛŒ
                    torque = T_pullup - (T_pullup - T_rated) * ((speed - 0.2 * Ns) / (0.6 * Ns));
                } else if (speed < Ns) {
                    // Ù…Ù†Ø·Ù‚Ù‡ Ú©Ø§Ø±ÛŒ
                    const slip = (Ns - speed) / Ns;
                    torque = T_breakdown * (2 * slip) / (0.1 + slip * slip);
                } else {
                    torque = 0;
                }
                
                torques.push(torque);
            }
            
            // Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¯Ø§Ù„
            document.getElementById('motorChartModal').classList.add('active');
            
            // Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
            if (motorChartInstance) {
                motorChartInstance.destroy();
            }
            
            const ctx = document.getElementById('motorChart').getContext('2d');
            motorChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: speeds.map(s => s.toFixed(0)),
                    datasets: [{
                        label: 'Ú¯Ø´ØªØ§ÙˆØ± (Nm)',
                        data: torques,
                        borderColor: '#0891b2',
                        backgroundColor: 'rgba(8, 145, 178, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#0e7490',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                color: '#1e293b',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `Ú¯Ø´ØªØ§ÙˆØ±: ${context.parsed.y.toFixed(2)} Nm`;
                                },
                                title: function(context) {
                                    return `Ø³Ø±Ø¹Øª: ${context[0].label} RPM`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Ø³Ø±Ø¹Øª (RPM)',
                                color: '#1e293b',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                color: '#475569',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif'
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Ú¯Ø´ØªØ§ÙˆØ± (Nm)',
                                color: '#1e293b',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                color: '#475569',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif'
                                }
                            }
                        }
                    }
                }
            });
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø± ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±
        function showTransformerChart() {
            if (!transformerCalculationData) return;
            
            // Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¨Ø±Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
            const inputs = transformerCalculationData.inputs;
            const results = transformerCalculationData.results;
            
            const V2 = parseFloat(inputs['ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡ (V)']);
            const P = parseFloat(inputs['ØªÙˆØ§Ù† (VA)']);
            const efficiency = parseFloat(results['Ø¨Ø§Ø²Ø¯Ù‡ (%)']);
            
            // Ù…Ø­Ø§Ø³Ø¨Ø§Øª
            const I2_rated = P / V2;
            const V2_no_load = V2;
            const V2_full_load = V2 * (1 - (100 - efficiency) / 500); // Ø§ÙØª ÙˆÙ„ØªØ§Ú˜ ØªÙ‚Ø±ÛŒØ¨ÛŒ
            
            // ØªÙˆÙ„ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
            const currents = [];
            const voltages = [];
            const efficiencies = [];
            
            // ØªÙˆÙ„ÛŒØ¯ 20 Ù†Ù‚Ø·Ù‡ Ø§Ø² Ø¨ÛŒâ€ŒØ¨Ø§Ø±ÛŒ ØªØ§ Ø¨Ø§Ø± Ú©Ø§Ù…Ù„
            for (let i = 0; i <= 20; i++) {
                const load = i / 20; // 0 ØªØ§ 1
                const current = load * I2_rated;
                currents.push(current);
                
                // Ø§ÙØª ÙˆÙ„ØªØ§Ú˜ Ø¨Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ø§Ø±
                const voltage = V2_no_load - (V2_no_load - V2_full_load) * load;
                voltages.push(voltage);
                
                // Ø¨Ø§Ø²Ø¯Ù‡ (Ø­Ø¯Ø§Ú©Ø«Ø± Ø¯Ø± 80% Ø¨Ø§Ø±)
                let eff;
                if (load === 0) {
                    eff = 0;
                } else if (load <= 0.8) {
                    eff = efficiency * (load / 0.8);
                } else {
                    eff = efficiency * (1 - (load - 0.8) * 0.5);
                }
                efficiencies.push(eff);
            }
            
            // Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¯Ø§Ù„
            document.getElementById('transformerChartModal').classList.add('active');
            
            // Ø§ÛŒØ¬Ø§Ø¯ ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
            if (transformerChartInstance) {
                transformerChartInstance.destroy();
            }
            
            const ctx = document.getElementById('transformerChart').getContext('2d');
            transformerChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: currents.map(c => c.toFixed(2)),
                    datasets: [
                        {
                            label: 'ÙˆÙ„ØªØ§Ú˜ Ø®Ø±ÙˆØ¬ÛŒ (V)',
                            data: voltages,
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4,
                            yAxisID: 'y',
                            pointBackgroundColor: '#1d4ed8',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Ø¨Ø§Ø²Ø¯Ù‡ (%)',
                            data: efficiencies,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4,
                            yAxisID: 'y1',
                            borderDash: [5, 5],
                            pointBackgroundColor: '#059669',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                color: '#1e293b',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    if (context.datasetIndex === 0) {
                                        return `ÙˆÙ„ØªØ§Ú˜: ${context.parsed.y.toFixed(2)} V`;
                                    } else {
                                        return `Ø¨Ø§Ø²Ø¯Ù‡: ${context.parsed.y.toFixed(1)}%`;
                                    }
                                },
                                title: function(context) {
                                    return `Ø¬Ø±ÛŒØ§Ù†: ${context[0].label} A`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Ø¬Ø±ÛŒØ§Ù† Ø®Ø±ÙˆØ¬ÛŒ (A)',
                                color: '#1e293b',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                color: '#475569',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif'
                                }
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'ÙˆÙ„ØªØ§Ú˜ (V)',
                                color: '#2563eb',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            ticks: {
                                color: '#475569',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif'
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Ø¨Ø§Ø²Ø¯Ù‡ (%)',
                                color: '#10b981',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif',
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            ticks: {
                                color: '#475569',
                                font: {
                                    family: 'Tahoma, Arial, sans-serif'
                                }
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø³ØªÙ† Ù†Ù…ÙˆØ¯Ø§Ø±
        function closeChart(type) {
            if (type === 'motor') {
                document.getElementById('motorChartModal').classList.remove('active');
                if (motorChartInstance) {
                    motorChartInstance.destroy();
                    motorChartInstance = null;
                }
            } else {
                document.getElementById('transformerChartModal').classList.remove('active');
                if (transformerChartInstance) {
                    transformerChartInstance.destroy();
                    transformerChartInstance = null;
                }
            }
        }

        // Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø¯ Ù¾Ø³ Ø§Ø² Ù„ÙˆØ¯ ØµÙØ­Ù‡
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
        });
    </script>
</body>
</html>
