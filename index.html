<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ ØªØ®ØµØµÛŒ Ø§Ù„Ú©ØªØ±ÛŒÚ©Ø§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <!-- SheetJS Library for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            overflow-x: hidden;
            background: #0a0a0a;
        }
        .hidden {
            display: none !important;
        }
        
        /* Animated Background with Moving Gradient */
        .animated-bg {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 25%, #0891b2 50%, #7c3aed 75%, #1e293b 100%);
            background-size: 400% 400%;
            animation: gradientFlow 20s ease infinite;
            z-index: -3;
        }
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Fonts */
        @font-face {
            font-family: 'Plasma Circle';
            src: url('Plasma-Circle-Dots.ttf') format('truetype'),
                 url('Plasma-Circle-Dots.woff2') format('woff2'),
                 url('Plasma-Circle-Dots.woff') format('woff');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        
        body, 
        html:lang(fa), 
        [lang="fa"], 
        [dir="rtl"] {
            font-family: 'Plasma Circle', Tahoma, Arial, sans-serif !important;
        }
        
        /* Circuit Background */
        .circuit-bg {
            position: fixed;
            inset: 0;
            z-index: -2;
            opacity: 0.15;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 100px, rgba(59, 130, 246, 0.3) 100px, rgba(59, 130, 246, 0.3) 102px),
                repeating-linear-gradient(90deg, transparent, transparent 100px, rgba(59, 130, 246, 0.3) 100px, rgba(59, 130, 246, 0.3) 102px);
            animation: circuitMove 60s linear infinite;
        }
        @keyframes circuitMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(100px, 100px); }
        }
        
        /* Electric Lightning Effect */
        .lightning-container {
            position: fixed;
            inset: 0;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }
        .lightning {
            position: absolute;
            width: 2px;
            height: 100%;
            background: linear-gradient(to bottom, 
                transparent 0%, 
                rgba(59, 130, 246, 0.8) 30%, 
                rgba(139, 92, 246, 0.8) 50%, 
                rgba(59, 130, 246, 0.8) 70%, 
                transparent 100%);
            opacity: 0;
            animation: lightning 8s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.8);
        }
        @keyframes lightning {
            0%, 90%, 100% { opacity: 0; transform: scaleY(0); }
            91% { opacity: 1; transform: scaleY(1); }
            92% { opacity: 0; transform: scaleY(1); }
            93% { opacity: 1; transform: scaleY(1); }
            94%, 100% { opacity: 0; transform: scaleY(1); }
        }
        
        /* Floating Particles */
        .particles {
            position: fixed;
            inset: 0;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            animation: floatParticle 20s infinite;
        }
        @keyframes floatParticle {
            0%, 100% {
                transform: translateY(0) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translateY(-20vh) translateX(20px) scale(1);
            }
            90% {
                opacity: 1;
                transform: translateY(-90vh) translateX(-50px) scale(1);
            }
            100% {
                transform: translateY(-100vh) translateX(100px) scale(0);
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(60px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-60px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        @keyframes glowPulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
            }
            50% {
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.6);
            }
        }
        
        /* Circular User System */
        .user-circle-container {
            position: fixed;
            top: 25px;
            left: 25px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .user-circle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            animation: pulse 3s ease-in-out infinite;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .user-circle:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.6);
        }
        
        .user-circle::before {
            content: '';
            position: absolute;
            inset: -5px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            opacity: 0.3;
            filter: blur(10px);
            z-index: -1;
            animation: rotate 20s linear infinite;
        }
        
        .user-circle-initial {
            color: white;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .user-circle-login {
            color: white;
            font-size: 24px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .user-name-box {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.9), rgba(30, 64, 175, 0.9));
            color: white;
            padding: 10px 25px;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            min-width: 120px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);
            transform: translateY(10px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
        }
        
        .user-name-box.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* Notification System */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .notification {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.95), rgba(217, 119, 6, 0.95));
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
            animation: slideInRight 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 350px;
        }
        
        .notification.warning {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.95), rgba(220, 38, 38, 0.95));
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }
        
        .notification.success {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.95), rgba(21, 128, 61, 0.95));
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
        }
        
        /* Page Container */
        .page {
            display: none;
            min-height: 100vh;
            padding: 2rem;
            animation: fadeIn 0.6s ease-out;
        }
        .page.active {
            display: block;
        }
        
        /* Welcome Page */
        .welcome-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header with Logo */
        .welcome-header {
            display: flex;
            align-items: center;
            gap: 3rem;
            margin-bottom: 4rem;
            animation: slideInRight 0.8s ease-out;
        }
        
        /* Logo Container */
        .logo-container {
            width: 120px;
            height: 120px;
            position: relative;
            flex-shrink: 0;
            animation: pulse 3s ease-in-out infinite;
        }
        .logo-ring {
            position: absolute;
            inset: -8px;
            transform: rotate(45deg);
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.4), rgba(139, 92, 246, 0.4));
            backdrop-filter: blur(20px);
            border: 3px solid rgba(255, 255, 255, 0.3);
            animation: rotate 20s linear infinite, glowPulse 3s ease-in-out infinite;
        }
        .logo-inner {
            position: absolute;
            inset: 0;
            transform: rotate(45deg);
            border-radius: 18px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        .logo-inner img {
            width: 70%;
            height: 70%;
            object-fit: contain;
            position: relative;
            z-index: 2;
            transform: rotate(-45deg);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        
        /* Header Text */
        .header-text {
            flex: 1;
            color: white;
        }
        .header-text h1 {
            font-size: clamp(2rem, 5vw, 3.2rem);
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #fff, #e0e7ff, #c7d2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
            position: relative;
        }
        .header-text h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 0;
            width: 200px;
            height: 4px;
            background: linear-gradient(90deg, transparent, #3b82f6, #8b5cf6);
            border-radius: 2px;
        }
        .header-text p {
            font-size: clamp(1.1rem, 3vw, 1.8rem);
            opacity: 0.95;
            margin-bottom: 0.5rem;
        }
        .subtitle {
            font-size: clamp(0.9rem, 2vw, 1.2rem);
            opacity: 0.85;
        }
        
        /* Calculator Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
            animation: slideInUp 0.8s ease-out 0.2s both;
        }
        .calc-card {
            position: relative;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
        }
        .calc-card:hover {
            transform: translateY(-20px) scale(1.02);
            box-shadow: 0 50px 100px rgba(0, 0, 0, 0.6),
                0 0 80px rgba(59, 130, 246, 0.4);
        }
        
        /* Card Image Area */
        .card-image {
            height: 300px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        .card-image img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5));
            transition: transform 0.5s;
        }
        .calc-card:hover .card-image img {
            transform: scale(1.1) rotate(5deg);
        }
        
        /* Card Content */
        .card-content {
            padding: 2.5rem;
            background: linear-gradient(135deg, rgba(8, 145, 178, 0.9), rgba(14, 116, 144, 0.9));
            color: white;
        }
        .calc-card.blue .card-content {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.9), rgba(30, 64, 175, 0.9));
        }
        .card-content h2 {
            font-size: 1.8rem;
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        .card-content h2 .emoji {
            font-size: 2rem;
            animation: pulse 2s ease-in-out infinite;
        }
        .card-content p {
            font-size: 1.1rem;
            line-height: 1.8;
            opacity: 0.95;
            margin-bottom: 2rem;
        }
        .card-cta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 1.1rem;
            font-weight: 600;
        }
        .card-cta .arrow {
            font-size: 1.8rem;
            transition: transform 0.3s;
        }
        .calc-card:hover .card-cta .arrow {
            transform: translateX(-10px);
        }
        
        /* Footer Badge */
        .footer-badge {
            text-align: center;
            animation: slideInUp 0.8s ease-out 0.4s both;
        }
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            padding: 1.2rem 2.5rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(30px);
            border-radius: 50px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.1rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .version-tag {
            background: rgba(255, 255, 255, 0.25);
            padding: 0.4rem 1rem;
            border-radius: 25px;
            font-weight: 700;
        }
        
        /* Calculator Page */
        .calc-container {
            max-width: 1800px;
            margin: 0 auto;
        }
        .calc-header {
            background: linear-gradient(135deg, rgba(8, 145, 178, 0.95), rgba(14, 116, 144, 0.95));
            color: white;
            padding: 2rem;
            border-radius: 30px;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 60px rgba(8, 145, 178, 0.4);
            animation: slideInUp 0.6s ease-out;
        }
        .calc-header.blue {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.95), rgba(30, 64, 175, 0.95));
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.9rem 1.8rem;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            transition: all 0.3s;
        }
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(8px);
        }
        .calc-header h1 {
            font-size: clamp(1.6rem, 4vw, 2.5rem);
            margin-bottom: 0.6rem;
        }
        .calc-header p {
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            opacity: 0.95;
        }
        
        /* Calculator Grid */
        .calc-grid {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 2rem;
        }
        @media (max-width: 1200px) {
            .calc-grid {
                grid-template-columns: 1fr;
            }
        }
        .calc-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
            animation: slideInUp 0.6s ease-out;
        }
        .panel-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #e0e7ff;
        }
        .panel-header h2 {
            font-size: 1.4rem;
            color: #1e293b;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #e0f2fe, #dbeafe);
            padding: 0.5rem;
            border-radius: 20px;
        }
        .tab {
            flex: 1;
            padding: 0.8rem 1rem;
            background: transparent;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 700;
            color: #475569;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        .tab.active {
            background: linear-gradient(135deg, #0891b2, #0e7490);
            color: white;
            box-shadow: 0 8px 20px rgba(8, 145, 178, 0.4);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 1.2rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 700;
            color: #1e293b;
            font-size: 0.9rem;
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid #cbd5e1;
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.3s;
            background: white;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #0891b2;
            box-shadow: 0 0 0 4px rgba(8, 145, 178, 0.2);
        }
        
        /* Radio Options */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }
        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.9rem 1.2rem;
            background: linear-gradient(135deg, #e0f2fe, #dbeafe);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        .radio-option input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        /* Calculate Button */
        .calc-btn {
            width: 100%;
            padding: 1.2rem;
            margin-top: 1.5rem;
            background: linear-gradient(135deg, #0891b2, #0e7490);
            color: white;
            border: none;
            border-radius: 18px;
            font-size: 1.2rem;
            font-weight: 800;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            box-shadow: 0 15px 40px rgba(8, 145, 178, 0.4);
            transition: all 0.4s;
        }
        .calc-btn:hover {
            background: linear-gradient(135deg, #0e7490, #155e75);
            transform: translateY(-5px);
        }
        
        /* Export Button */
        .export-btn {
            width: 100%;
            padding: 1rem;
            margin-top: 1rem;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
            transition: all 0.3s;
        }
        .export-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-3px);
        }
        
        /* Results */
        .result-placeholder {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, #f8fafc, #e0f2fe);
            border: 3px dashed #cbd5e1;
            border-radius: 25px;
        }
        .result-placeholder p {
            font-size: 1.1rem;
            color: #64748b;
        }
        .result-section {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: white;
            border: 3px solid #e5e7eb;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            animation: slideInUp 0.4s ease-out;
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0.6rem 0;
            padding: 1rem 1.2rem;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 12px;
            border-right: 4px solid #0891b2;
        }
        .result-label {
            color: #64748b;
            font-weight: 700;
            font-size: 0.95rem;
        }
        .result-value {
            color: #1e293b;
            font-weight: 800;
            font-size: 1.05rem;
            font-family: 'Courier New', monospace;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            border-radius: 25px;
            padding: 2.5rem;
            width: 90%;
            max-width: 500px;
            border: 2px solid rgba(59, 130, 246, 0.5);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
            position: relative;
            animation: slideInUp 0.4s ease-out;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .modal-title {
            font-size: 1.8rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .close-modal {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid rgba(239, 68, 68, 0.5);
            color: #f87171;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            background: rgba(239, 68, 68, 0.4);
            transform: rotate(90deg);
        }
        
        /* User Panel Modal */
        .user-panel-section {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 2px solid #334155;
        }
        
        .sound-control {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 12px;
            margin-bottom: 1rem;
            border: 2px solid rgba(59, 130, 246, 0.3);
        }
        
        .sound-toggle-btn {
            width: 60px;
            height: 30px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sound-toggle-btn.active {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .sound-toggle-btn::after {
            content: '';
            position: absolute;
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            top: 2px;
            right: 2px;
            transition: all 0.3s;
        }
        
        .sound-toggle-btn.active::after {
            right: calc(100% - 28px);
        }
        
        .ticket-type-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 1.5rem;
        }
        
        .ticket-type {
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid #334155;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .ticket-type:hover {
            border-color: #3b82f6;
        }
        
        .ticket-type.selected {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }
        
        .ticket-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1.5rem;
        }
        
        .ticket-item {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            border-left: 4px solid #3b82f6;
        }
        
        /* Spam Protection */
        .spam-block {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10001;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .spam-block.active {
            display: flex;
        }
        
        .spam-timer {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            .welcome-header {
                flex-direction: column;
                text-align: center;
            }
            .header-text h1::after {
                right: 50%;
                transform: translateX(50%);
            }
            .calc-header {
                padding: 1.5rem;
            }
            .calc-panel {
                padding: 1.5rem;
            }
            .calc-grid {
                grid-template-columns: 1fr;
            }
            .user-circle-container {
                top: 15px;
                left: 15px;
            }
            .user-circle {
                width: 60px;
                height: 60px;
            }
            .user-circle-initial {
                font-size: 24px;
            }
            .notification {
                max-width: 300px;
                padding: 12px 20px;
            }
            .ticket-type-selector {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    
    <!-- Circuit Background -->
    <div class="circuit-bg"></div>
    
    <!-- Lightning Effects -->
    <div class="lightning-container">
        <div class="lightning"></div>
        <div class="lightning"></div>
        <div class="lightning"></div>
    </div>
    
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>
    
    <!-- Circular User System -->
    <div class="user-circle-container">
        <div class="user-circle" onclick="toggleUserPanel()">
            <div id="userCircleContent" class="user-circle-login">ğŸ‘¤</div>
        </div>
        <div class="user-name-box" id="userNameBox"></div>
    </div>
    
    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>
    
    <!-- Spam Protection Block -->
    <div class="spam-block" id="spamBlock">
        <div class="spam-timer" id="spamTimer">60</div>
        <h2>Ø´Ù…Ø§ Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø§Ø³Ù¾Ù… Ú©Ø±Ø¯Ù† Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!</h2>
        <p>Ù„Ø·ÙØ§Ù‹ 60 Ø«Ø§Ù†ÛŒÙ‡ ØµØ¨Ø± Ú©Ù†ÛŒØ¯</p>
    </div>
    
    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h2>
                <button class="close-modal" onclick="closeLoginModal()">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</label>
                    <input type="text" id="username" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                <div class="form-group">
                    <label>Ø§ÛŒÙ…ÛŒÙ„</label>
                    <input type="email" id="email" placeholder="Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                <div class="form-group">
                    <label>Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
                </div>
                <button class="calc-btn" onclick="handleLogin()" id="loginBtn">
                    <span>ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- User Panel Modal -->
    <div class="modal-overlay" id="userPanelModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Ù¾Ù†Ù„ Ú©Ø§Ø±Ø¨Ø±ÛŒ</h2>
                <button class="close-modal" onclick="closeUserPanel()">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="user-panel-section">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <div class="user-circle" style="width: 50px; height: 50px;">
                            <div class="user-circle-initial" id="panelUserInitial">U</div>
                        </div>
                        <div>
                            <h3 style="color: white; margin: 0;" id="panelUsername">Ú©Ø§Ø±Ø¨Ø± Ù…Ù‡Ù…Ø§Ù†</h3>
                            <p style="color: #94a3b8; margin: 0;" id="panelEmail">ÙˆØ§Ø±Ø¯ Ø³ÛŒØ³ØªÙ… Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯</p>
                        </div>
                    </div>
                    
                    <div class="sound-control">
                        <span style="color: white; font-weight: 600;">ØµØ¯Ø§: </span>
                        <div class="sound-toggle-btn active" id="soundToggleBtn" onclick="toggleSound()"></div>
                    </div>
                </div>
                
                <div class="user-panel-section">
                    <h3 style="color: white; margin-bottom: 1rem;">Ø§ÛŒØ¬Ø§Ø¯ ØªÛŒÚ©Øª Ø¬Ø¯ÛŒØ¯</h3>
                    <div class="ticket-type-selector">
                        <div class="ticket-type selected" onclick="selectTicketType('support')">
                            <div style="font-size: 24px;">ğŸ’¬</div>
                            <div>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</div>
                        </div>
                        <div class="ticket-type" onclick="selectTicketType('suggestion')">
                            <div style="font-size: 24px;">ğŸ’¡</div>
                            <div>Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯</div>
                        </div>
                        <div class="ticket-type" onclick="selectTicketType('bug')">
                            <div style="font-size: 24px;">ğŸ›</div>
                            <div>Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§Ú¯</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label style="color: white;">Ø¹Ù†ÙˆØ§Ù† ØªÛŒÚ©Øª</label>
                        <input type="text" id="ticketTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† ØªÛŒÚ©Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                    </div>
                    <div class="form-group">
                        <label style="color: white;">Ù…ØªÙ† ØªÛŒÚ©Øª</label>
                        <textarea id="ticketMessage" rows="4" placeholder="Ù…ØªÙ† ØªÛŒÚ©Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..." style="width: 100%; padding: 0.8rem; border-radius: 12px; border: 2px solid #cbd5e1; background: white;"></textarea>
                    </div>
                    <button class="calc-btn" onclick="createTicket()" id="createTicketBtn">
                        <span>Ø§ÛŒØ¬Ø§Ø¯ ØªÛŒÚ©Øª</span>
                    </button>
                </div>
                
                <div class="user-panel-section">
                    <h3 style="color: white; margin-bottom: 1rem;">ØªÛŒÚ©Øªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„</h3>
                    <div class="ticket-list" id="ticketList">
                        <div style="text-align: center; color: #94a3b8; padding: 2rem;">
                            ØªÛŒÚ©ØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Welcome Page -->
    <div id="welcomePage" class="page active">
        <div class="welcome-container">
            <!-- Header with Logo -->
            <div class="welcome-header">
                <div class="logo-container">
                    <div class="logo-ring"></div>
                    <div class="logo-inner">
                        <img src="logo.png" alt="Logo" onerror="this.style.display='none';">
                    </div>
                </div>
                <!-- Header Text -->
                <div class="header-text">
                    <h1>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ø§Ù„Ú©ØªØ±ÛŒÚ©Ø§Ù„</h1>
                    <p>Ø§Ø¨Ø²Ø§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ø¨Ø±Ù‚</p>
                    <p class="subtitle">Ù„Ø·ÙØ§Ù‹ ÛŒÚ©ÛŒ Ø§Ø² Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</p>
                </div>
            </div>
            
            <!-- Calculator Cards -->
            <div class="cards-grid">
                <!-- Motor Calculator Card -->
                <div class="calc-card cyan" onclick="selectCalculator('motor')">
                    <div class="card-image">
                        <img src="t1.png" alt="Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±">
                    </div>
                    <div class="card-content">
                        <h2>
                            <span class="emoji">âš™ï¸</span>
                            <span>Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±</span>
                        </h2>
                        <p>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ± Ø³Ù‡ ÙØ§Ø² Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§ Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø§Ù†ÙˆØ§Ø¹ Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ</p>
                        <div class="card-cta">
                            <span>Ø´Ø±ÙˆØ¹ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</span>
                            <span class="arrow">â†</span>
                        </div>
                    </div>
                </div>
                
                <!-- Transformer Calculator Card -->
                <div class="calc-card blue" onclick="selectCalculator('transformer')">
                    <div class="card-image">
                        <img src="t2.png" alt="ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±">
                    </div>
                    <div class="card-content">
                        <h2>
                            <span class="emoji">ğŸ“Š</span>
                            <span>Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</span>
                        </h2>
                        <p>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚ ØªÙ…Ø§Ù… Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ± Ø¨Ø§ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø§Ù†ÙˆØ§Ø¹ Ù‡Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù</p>
                        <div class="card-cta">
                            <span>Ø´Ø±ÙˆØ¹ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</span>
                            <span class="arrow">â†</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer Badge -->
            <div class="footer-badge">
                <div class="badge">
                    <span>Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ ØªÙˆØ³Ø·</span>
                    <strong>Ù¾Ø§Ø±Ø³Ø§</strong>
                    <span class="version-tag">Ù†Ø³Ø®Ù‡ Û².Û°</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Motor Calculator Page -->
    <div id="motorPage" class="page">
        <div class="calc-container">
            <!-- Header -->
            <div class="calc-header">
                <button class="back-btn" onclick="backToWelcome()">
                    <span>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</span>
                </button>
                <h1>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±</h1>
                <p>Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªØ®ØµØµÛŒ Ù…ÙˆØªÙˆØ±Ù‡Ø§ÛŒ Ø³Ù‡ ÙØ§Ø² â€” Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§ÛŒ Ù…Ù‡Ù†Ø¯Ø³ÛŒ</p>
            </div>
            
            <!-- Calculator Grid -->
            <div class="calc-grid">
                <!-- Input Panel -->
                <div class="calc-panel">
                    <div class="panel-header">
                        <h2>ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§</h2>
                    </div>
                    
                    <!-- Tabs -->
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('basic', 'motor')">Ù¾Ø§ÛŒÙ‡</button>
                        <button class="tab" onclick="switchTab('winding', 'motor')">Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ</button>
                    </div>
                    
                    <!-- Basic Tab -->
                    <div id="motor-basic-tab" class="tab-content active">
                        <div class="form-group">
                            <label>ØªÙˆØ§Ù† (kW)</label>
                            <input type="number" id="motorPower" value="1.5" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label>ÙˆÙ„ØªØ§Ú˜ (V)</label>
                            <input type="number" id="motorVoltage" value="380" min="1">
                        </div>
                        <div class="form-group">
                            <label>Ø¬Ø±ÛŒØ§Ù† (A)</label>
                            <input type="number" id="motorCurrent" value="3.5" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label>ÙØ±Ú©Ø§Ù†Ø³ (Hz)</label>
                            <input type="number" id="motorFrequency" value="50" min="1">
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø±Ø¹Øª (RPM)</label>
                            <input type="number" id="motorRPM" value="1440" min="1">
                        </div>
                    </div>
                    
                    <!-- Winding Tab -->
                    <div id="motor-winding-tab" class="tab-content">
                        <div class="form-group">
                            <label>ØªØ¹Ø¯Ø§Ø¯ Ø´ÛŒØ§Ø±Ù‡Ø§ (Z)</label>
                            <input type="number" id="slotNumber" value="24" min="1">
                        </div>
                        <div class="form-group">
                            <label>ØªØ¹Ø¯Ø§Ø¯ ÙØ§Ø²Ù‡Ø§ (m)</label>
                            <input type="number" id="phaseNumber" value="3" disabled>
                        </div>
                        <div class="form-group">
                            <label>ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø·Ø¨â€ŒÙ‡Ø§ (P)</label>
                            <input type="number" id="poleNumber" value="4" min="2" step="2">
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ø³ÛŒÙ… Ù¾ÛŒÚ†ÛŒ:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="windingType" value="full" checked>
                                    <span>Ú¯Ø§Ù… Ú©Ø§Ù…Ù„</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="windingType" value="fractional">
                                    <span>Ú¯Ø§Ù… Ú©Ø³Ø±ÛŒ</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ù‚Ø·Ø± Ø³ÛŒÙ… (mm)</label>
                            <input type="number" id="wireDiameterMotor" value="0.8" min="0.1" max="5" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Ø§ØªØµØ§Ù„:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="connectionType" value="star" checked>
                                    <span>Ø³ØªØ§Ø±Ù‡ (Y)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="connectionType" value="delta">
                                    <span>Ù…Ø«Ù„Ø« (âˆ†)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Calculate Button -->
                    <button class="calc-btn" onclick="calculateMotor()">
                        <span id="motorCalcBtnText">Ù…Ø­Ø§Ø³Ø¨Ù‡</span>
                    </button>
                </div>
                
                <!-- Results Panel -->
                <div class="calc-panel">
                    <div class="panel-header">
                        <h2>Ù†ØªØ§ÛŒØ¬</h2>
                    </div>
                    <div id="motorResults">
                        <div class="result-placeholder">
                            <p>Ù†ØªØ§ÛŒØ¬ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
                        </div>
                    </div>
                    <button class="export-btn hidden" id="motorExportBtn" onclick="exportMotorToExcel()">
                        <span>Ø¯Ø§Ù†Ù„ÙˆØ¯ Excel</span>
                    </button>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="calc-footer">
                <div class="badge">
                    <span>Ø·Ø±Ø§Ø­ÛŒ ØªÙˆØ³Ø·</span>
                    <strong>Ù¾Ø§Ø±Ø³Ø§</strong>
                    <span>|</span>
                    <span>Ù†Ø³Ø®Ù‡ Û².Û°</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Transformer Calculator Page -->
    <div id="transformerPage" class="page">
        <div class="calc-container">
            <!-- Header -->
            <div class="calc-header blue">
                <button class="back-btn" onclick="backToWelcome()">
                    <span>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</span>
                </button>
                <h1>Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</h1>
                <p>Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¯Ù‚ÛŒÙ‚ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±</p>
            </div>
            
            <!-- Calculator Grid -->
            <div class="calc-grid">
                <!-- Input Panel -->
                <div class="calc-panel">
                    <div class="panel-header">
                        <h2>ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§</h2>
                    </div>
                    
                    <!-- Tabs -->
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('basic', 'transformer')">Ù¾Ø§ÛŒÙ‡</button>
                        <button class="tab" onclick="switchTab('advanced', 'transformer')">Ù¾ÛŒØ´Ø±ÙØªÙ‡</button>
                        <button class="tab" onclick="switchTab('core', 'transformer')">Ù‡Ø³ØªÙ‡</button>
                    </div>
                    
                    <!-- Basic Tab -->
                    <div id="transformer-basic-tab" class="tab-content active">
                        <div class="form-group">
                            <label>ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡ (V)</label>
                            <input type="number" id="primaryVoltage" value="220" min="1" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡ (V)</label>
                            <input type="number" id="secondaryVoltage" value="12" min="1" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ ÙˆØ±ÙˆØ¯ÛŒ:</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="powerType" value="power" checked onchange="togglePowerType()">
                                    <span>ØªÙˆØ§Ù† (VA)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="powerType" value="current" onchange="togglePowerType()">
                                    <span>Ø¬Ø±ÛŒØ§Ù† (A)</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group" id="powerGroup">
                            <label>ØªÙˆØ§Ù† (VA)</label>
                            <input type="number" id="power" value="100" min="1" step="0.1">
                        </div>
                        <div class="form-group hidden" id="currentGroup">
                            <label>Ø¬Ø±ÛŒØ§Ù† (A)</label>
                            <input type="number" id="secondaryCurrent" value="8.33" min="0.1" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>ÙØ±Ú©Ø§Ù†Ø³ (Hz)</label>
                            <input type="number" id="frequency" value="50" min="1">
                        </div>
                    </div>
                    
                    <!-- Advanced Tab -->
                    <div id="transformer-advanced-tab" class="tab-content">
                        <div class="form-group">
                            <label>Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)</label>
                            <input type="number" id="fluxDensity" value="1.2" min="0.8" max="1.6" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)</label>
                            <input type="number" id="currentDensity" value="3" min="1" max="5" step="0.1">
                        </div>
                    </div>
                    
                    <!-- Core Tab -->
                    <div id="transformer-core-tab" class="tab-content">
                        <div class="form-group">
                            <label>Ø³Ø·Ø­ Ù‡Ø³ØªÙ‡ (cmÂ²)</label>
                            <input type="number" id="coreAreaTrans" value="6.0" min="1" step="0.1">
                        </div>
                    </div>
                    
                    <!-- Calculate Button -->
                    <button class="calc-btn" onclick="calculateTransformer()">
                        <span id="transformerCalcBtnText">Ù…Ø­Ø§Ø³Ø¨Ù‡</span>
                    </button>
                </div>
                
                <!-- Results Panel -->
                <div class="calc-panel">
                    <div class="panel-header">
                        <h2>Ù†ØªØ§ÛŒØ¬</h2>
                    </div>
                    <div id="transformerResults">
                        <div class="result-placeholder">
                            <p>Ù†ØªØ§ÛŒØ¬ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
                        </div>
                    </div>
                    <button class="export-btn hidden" id="transformerExportBtn" onclick="exportTransformerToExcel()">
                        <span>Ø¯Ø§Ù†Ù„ÙˆØ¯ Excel</span>
                    </button>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="calc-footer">
                <div class="badge">
                    <span>Ø·Ø±Ø§Ø­ÛŒ ØªÙˆØ³Ø·</span>
                    <strong>Ù¾Ø§Ø±Ø³Ø§</strong>
                    <span>|</span>
                    <span>Ù†Ø³Ø®Ù‡ Û².Û°</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Global Variables
        let currentUser = null;
        let soundEnabled = true;
        let spamClickCount = 0;
        let lastClickTime = 0;
        let isBlocked = false;
        let userTickets = [];
        let selectedTicketType = 'support';
        let audioContext;
        let currentAudio = null;
        
        // Initialize system
        function initSystem() {
            createParticles();
            loadUserData();
            setupSoundSystem();
            setupSpamProtection();
            setupSecurity();
            
            // Attach spam protection to all buttons
            document.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', handleButtonClick);
            });
        }
        
        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particlesContainer.appendChild(particle);
            }
        }
        
        // Navigation functions
        function selectCalculator(type) {
            document.getElementById('welcomePage').classList.remove('active');
            if (type === 'motor') {
                document.getElementById('motorPage').classList.add('active');
            } else {
                document.getElementById('transformerPage').classList.add('active');
            }
            playSound('click');
        }
        
        function backToWelcome() {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById('welcomePage').classList.add('active');
            playSound('click');
        }
        
        // Tab switching
        function switchTab(tabName, pageType) {
            const prefix = pageType === 'motor' ? 'motor-' : 'transformer-';
            document.querySelectorAll(`#${pageType}Page .tab`).forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll(`#${pageType}Page .tab-content`).forEach(c => c.classList.remove('active'));
            document.getElementById(prefix + tabName + '-tab').classList.add('active');
            playSound('click');
        }
        
        // Power type toggle
        function togglePowerType() {
            const powerType = document.querySelector('input[name="powerType"]:checked').value;
            document.getElementById('powerGroup').classList.toggle('hidden', powerType !== 'power');
            document.getElementById('currentGroup').classList.toggle('hidden', powerType !== 'current');
            playSound('toggle');
        }
        
        // ========== CIRCULAR USER SYSTEM ==========
        function toggleUserPanel() {
            if (currentUser) {
                showUserPanel();
            } else {
                showLoginModal();
            }
        }
        
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
            playSound('modal');
        }
        
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
            playSound('click');
        }
        
        function showUserPanel() {
            updateUserPanel();
            document.getElementById('userPanelModal').classList.add('active');
            playSound('modal');
        }
        
        function closeUserPanel() {
            document.getElementById('userPanelModal').classList.remove('active');
            playSound('click');
        }
        
        function handleLogin() {
            const username = document.getElementById('username').value.trim();
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!username || !email || !password) {
                showNotification('Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯', 'warning');
                return;
            }
            
            if (!isValidEmail(email)) {
                showNotification('Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'warning');
                return;
            }
            
            // Save user data
            currentUser = {
                username: username,
                email: email,
                joinDate: new Date().toISOString()
            };
            
            localStorage.setItem('electrical_calc_user', JSON.stringify(currentUser));
            
            // Update UI
            updateUserCircle();
            document.getElementById('loginModal').classList.remove('active');
            showNotification('Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆØ§Ø±Ø¯ Ø´Ø¯ÛŒØ¯!', 'success');
            playSound('success');
        }
        
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        function loadUserData() {
            const saved = localStorage.getItem('electrical_calc_user');
            if (saved) {
                try {
                    currentUser = JSON.parse(saved);
                    updateUserCircle();
                } catch (e) {
                    console.log('Error loading user data');
                }
            }
            
            const savedTickets = localStorage.getItem('user_tickets');
            if (savedTickets) {
                try {
                    userTickets = JSON.parse(savedTickets);
                } catch (e) {
                    console.log('Error loading tickets');
                }
            }
            
            const savedSound = localStorage.getItem('sound_enabled');
            if (savedSound !== null) {
                soundEnabled = savedSound === 'true';
                updateSoundToggle();
            }
        }
        
        function updateUserCircle() {
            const userCircleContent = document.getElementById('userCircleContent');
            const userNameBox = document.getElementById('userNameBox');
            
            if (currentUser) {
                // Show user initial
                userCircleContent.className = 'user-circle-initial';
                userCircleContent.textContent = currentUser.username.charAt(0).toUpperCase();
                
                // Show name box
                userNameBox.textContent = currentUser.username;
                userNameBox.classList.add('show');
                
                // Update panel
                document.getElementById('panelUsername').textContent = currentUser.username;
                document.getElementById('panelEmail').textContent = currentUser.email;
                document.getElementById('panelUserInitial').textContent = currentUser.username.charAt(0).toUpperCase();
            } else {
                // Show login icon
                userCircleContent.className = 'user-circle-login';
                userCircleContent.textContent = 'ğŸ‘¤';
                
                // Hide name box
                userNameBox.classList.remove('show');
            }
        }
        
        // ========== SOUND SYSTEM ==========
        function setupSoundSystem() {
            // Create audio context
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log('Web Audio API not supported');
            }
        }
        
        function toggleSound() {
            soundEnabled = !soundEnabled;
            localStorage.setItem('sound_enabled', soundEnabled);
            updateSoundToggle();
            playSound('toggle');
        }
        
        function updateSoundToggle() {
            const toggleBtn = document.getElementById('soundToggleBtn');
            if (soundEnabled) {
                toggleBtn.classList.add('active');
            } else {
                toggleBtn.classList.remove('active');
            }
        }
        
        function playSound(type) {
            if (!soundEnabled || !audioContext) return;
            
            try {
                // Stop previous sound if playing
                if (currentAudio) {
                    currentAudio.stop();
                }
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                let frequency = 440;
                let duration = 0.3;
                
                switch(type) {
                    case 'click':
                        // Pleasant click sound
                        frequency = 523.25; // C5
                        break;
                    case 'success':
                        // Success chime
                        frequency = 659.25; // E5
                        duration = 0.5;
                        break;
                    case 'error':
                        // Error sound
                        frequency = 392.00; // G4
                        break;
                    case 'login':
                        // Login success
                        frequency = 784.00; // G5
                        duration = 0.4;
                        break;
                    case 'toggle':
                        // Toggle sound
                        frequency = 349.23; // F4
                        break;
                    case 'modal':
                        // Modal open/close
                        frequency = 493.88; // B4
                        break;
                    case 'calculate':
                        // Calculation start
                        frequency = 587.33; // D5
                        duration = 0.4;
                        break;
                }
                
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                
                // Create envelope
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(aContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
                
                currentAudio = oscillator;
                
            } catch (e) {
                console.log('Error playing sound');
            }
        }
        
        // ========== USER PANEL FUNCTIONS ==========
        function selectTicketType(type) {
            selectedTicketType = type;
            document.querySelectorAll('.ticket-type').forEach(t => t.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            playSound('click');
        }
        
        function updateUserPanel() {
            if (!currentUser) return;
            
            const openTickets = userTickets.filter(t => t.status === 'open');
            const ticketList = document.getElementById('ticketList');
            
            if (openTickets.length === 0) {
                ticketList.innerHTML = '<div style="text-align: center; color: #94a3b8; padding: 2rem;">ØªÛŒÚ©ØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>';
            } else {
                let html = '';
                openTickets.slice(0, 5).forEach(ticket => {
                    const date = new Date(ticket.date);
                    const dateStr = `${date.getFullYear()}/${date.getMonth()+1}/${date.getDate()}`;
                    
                    html += `
                        <div class="ticket-item">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                <strong style="color: white;">${ticket.title}</strong>
                                <span style="background: rgba(34, 197, 94, 0.2); color: #86efac; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem;">
                                    ${ticket.type === 'support' ? 'Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ' : ticket.type === 'suggestion' ? 'Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯' : 'Ø¨Ø§Ú¯'}
                                </span>
                            </div>
                            <p style="color: #cbd5e1; margin: 0.5rem 0;">${ticket.message.substring(0, 80)}...</p>
                            <div style="color: #94a3b8; font-size: 0.8rem;">${dateStr}</div>
                        </div>
                    `;
                });
                ticketList.innerHTML = html;
            }
        }
        
        function createTicket() {
            if (!currentUser) {
                showNotification('Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯', 'warning');
                showLoginModal();
                return;
            }
            
            const title = document.getElementById('ticketTitle').value.trim();
            const message = document.getElementById('ticketMessage').value.trim();
            
            if (!title || !message) {
                showNotification('Ù„Ø·ÙØ§Ù‹ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù…ØªÙ† ØªÛŒÚ©Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'warning');
                return;
            }
            
            const newTicket = {
                id: Date.now(),
                title: title,
                message: message,
                type: selectedTicketType,
                status: 'open',
                date: new Date().toISOString(),
                user: currentUser.username
            };
            
            userTickets.unshift(newTicket);
            localStorage.setItem('user_tickets', JSON.stringify(userTickets));
            updateUserPanel();
            
            // Clear form
            document.getElementById('ticketTitle').value = '';
            document.getElementById('ticketMessage').value = '';
            
            showNotification('ØªÛŒÚ©Øª Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯', 'success');
            playSound('success');
        }
        
        // ========== SPAM PROTECTION ==========
        function setupSpamProtection() {
            setInterval(() => {
                if (spamClickCount > 0) {
                    spamClickCount = Math.max(0, spamClickCount - 1);
                }
            }, 60000);
        }
        
        function handleButtonClick() {
            if (isBlocked) {
                event.preventDefault();
                return;
            }
            
            const now = Date.now();
            const timeSinceLastClick = now - lastClickTime;
            
            if (timeSinceLastClick < 300) {
                spamClickCount++;
                
                if (spamClickCount >= 5 && spamClickCount < 10) {
                    showNotification(`Ù„Ø·ÙØ§Ù‹ Ø¢Ø±Ø§Ù… ØªØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯! (${spamClickCount}/10)`, 'warning');
                } else if (spamClickCount >= 10) {
                    blockUser();
                }
            } else {
                spamClickCount = Math.max(0, spamClickCount - 1);
            }
            
            lastClickTime = now;
        }
        
        function blockUser() {
            isBlocked = true;
            const spamBlock = document.getElementById('spamBlock');
            const spamTimer = document.getElementById('spamTimer');
            
            spamBlock.classList.add('active');
            
            let secondsLeft = 60;
            const timer = setInterval(() => {
                secondsLeft--;
                spamTimer.textContent = secondsLeft;
                
                if (secondsLeft <= 0) {
                    clearInterval(timer);
                    spamBlock.classList.remove('active');
                    isBlocked = false;
                    spamClickCount = 0;
                    showNotification('Ø¯Ø³ØªØ±Ø³ÛŒ Ø´Ù…Ø§ Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø´Ø¯', 'success');
                }
            }, 1000);
            
            showNotification('Ø´Ù…Ø§ Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø§Ø³Ù¾Ù… Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ù…Ø¯Øª 60 Ø«Ø§Ù†ÛŒÙ‡ Ù…Ø³Ø¯ÙˆØ¯ Ø´Ø¯ÛŒØ¯!', 'warning');
        }
        
        // ========== SECURITY ==========
        function setupSecurity() {
            // Prevent right-click
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                showNotification('Ø±Ø§Ø³Øª Ú©Ù„ÛŒÚ© Ø¯Ø± Ø§ÛŒÙ† Ø³Ø§ÛŒØª ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª', 'warning');
            });
            
            // Prevent F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
            document.addEventListener('keydown', function(e) {
                if (
                    e.key === 'F12' ||
                    (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||
                    (e.ctrlKey && e.key === 'u')
                ) {
                    e.preventDefault();
                    showNotification('Ø§ÛŒÙ† Ø¹Ù…Ù„ Ù…Ø¬Ø§Ø² Ù†ÛŒØ³Øª', 'warning');
                }
            });
        }
        
        // ========== NOTIFICATION SYSTEM ==========
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon = 'â„¹ï¸';
            if (type === 'success') icon = 'âœ…';
            if (type === 'warning') icon = 'âš ï¸';
            
            notification.innerHTML = `<span>${icon} ${message}</span>`;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100px)';
                setTimeout(() => {
                    container.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // ========== CALCULATION FUNCTIONS ==========
        let motorCalculationData = null;
        let transformerCalculationData = null;
        
        function calculateMotor() {
            const btn = document.getElementById('motorPage').querySelector('.calc-btn');
            const btnText = document.getElementById('motorCalcBtnText');
            btn.disabled = true;
            btnText.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡...';
            
            playSound('calculate');
            
            setTimeout(() => {
                const P_kW = parseFloat(document.getElementById('motorPower').value);
                const V_line = parseFloat(document.getElementById('motorVoltage').value);
                const I = parseFloat(document.getElementById('motorCurrent').value);
                const f = parseFloat(document.getElementById('motorFrequency').value);
                const Nr = parseFloat(document.getElementById('motorRPM').value);
                const Z = parseInt(document.getElementById('slotNumber').value);
                const P_poles = parseInt(document.getElementById('poleNumber').value);
                const windingType = document.querySelector('input[name="windingType"]:checked').value;
                const d_wire = parseFloat(document.getElementById('wireDiameterMotor').value);
                const connectionType = document.querySelector('input[name="connectionType"]:checked').value;
                
                // Calculations
                const Ns = (120 * f) / P_poles;
                const S = ((Ns - Nr) / Ns * 100).toFixed(2);
                const YP = Z / (2 * P_poles);
                const q = Z / (2 * P_poles * 3);
                const Î±e = (P_poles * 360) / Z;
                let YZ = Math.floor(YP);
                if (windingType === 'fractional') {
                    YZ = Math.floor(YP * 2 / 3);
                }
                
                const B = 1.0;
                const kw = 0.92;
                const Ac = 0.0018;
                const V_ph = connectionType === 'star' ? V_line / Math.sqrt(3) : V_line;
                const N_phase = V_ph / (4.44 * f * kw * B * Ac);
                const coilsPerPhase = Z / 6;
                const turnsPerCoil = Math.max(1, Math.round(N_phase / coilsPerPhase));
                const A_wire = (Math.PI * d_wire ** 2) / 4;
                const J = I / A_wire;
                const totalWireLength = (Z * turnsPerCoil * 0.3).toFixed(2);
                
                // Store calculation data
                motorCalculationData = {
                    inputs: { P_kW, V_line, I, f, Nr, Z, P_poles, windingType, d_wire, connectionType },
                    results: { Ns, S, YP, q, YZ, turnsPerCoil, J: J.toFixed(2), totalWireLength }
                };
                
                // Build results HTML
                let html = `
                    <div class="result-section">
                        <h3>Ù…Ø´Ø®ØµØ§Øª Ú©Ù„ÛŒ</h3>
                        <div class="result-item">
                            <span class="result-label">Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ†:</span>
                            <span class="result-value">${Ns.toFixed(0)} RPM</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ù„ØºØ²Ø´:</span>
                            <span class="result-value">${S}%</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ:</span>
                            <span class="result-value">${YP.toFixed(2)}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">q:</span>
                            <span class="result-value">${q.toFixed(2)}</span>
                        </div>
                    </div>
                    <div class="result-section">
                        <h3>Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ</h3>
                        <div class="result-item">
                            <span class="result-label">Ú¯Ø§Ù… Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ:</span>
                            <span class="result-value">${YZ}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø¯ÙˆØ± Ú©Ø§Ù„Ù:</span>
                            <span class="result-value">${turnsPerCoil}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù†:</span>
                            <span class="result-value">${J.toFixed(2)} A/mmÂ²</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø·ÙˆÙ„ Ø³ÛŒÙ…:</span>
                            <span class="result-value">${totalWireLength} m</span>
                        </div>
                    </div>
                `;
                
                // Check for warnings
                const warnings = [];
                if (q < 1 || q > 4) warnings.push(`q Ø®Ø§Ø±Ø¬ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ (${q.toFixed(2)})`);
                if (J > 3.5) warnings.push(`Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† Ø¨Ø§Ù„Ø§ (${J.toFixed(2)} A/mmÂ²)`);
                if (parseFloat(S) > 8) warnings.push(`Ù„ØºØ²Ø´ Ø¨Ø§Ù„Ø§ (${S}%)`);
                
                if (warnings.length > 0) {
                    html += `
                        <div class="result-section" style="border-color: #f87171;">
                            <h3 style="color: #991b1b;">âš ï¸ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§</h3>
                            ${warnings.map(w => `<div class="result-item"><span class="result-label">${w}</span></div>`).join('')}
                        </div>
                    `;
                }
                
                document.getElementById('motorResults').innerHTML = html;
                document.getElementById('motorExportBtn').classList.remove('hidden');
                
                btn.disabled = false;
                btnText.innerHTML = 'Ù…Ø­Ø§Ø³Ø¨Ù‡';
                
                playSound('success');
            }, 800);
        }
        
        function calculateTransformer() {
            const btn = document.getElementById('transformerPage').querySelector('.calc-btn');
            const btnText = document.getElementById('transformerCalcBtnText');
            btn.disabled = true;
            btnText.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡...';
            
            playSound('calculate');
            
            setTimeout(() => {
                const V1 = parseFloat(document.getElementById('primaryVoltage').value);
                const V2 = parseFloat(document.getElementById('secondaryVoltage').value);
                const f = parseFloat(document.getElementById('frequency').value);
                const Bmax = parseFloat(document.getElementById('fluxDensity').value);
                const J = parseFloat(document.getElementById('currentDensity').value);
                const Acore_cm2 = parseFloat(document.getElementById('coreAreaTrans').value);
                
                let P, I2;
                const powerType = document.querySelector('input[name="powerType"]:checked').value;
                if (powerType === 'power') {
                    P = parseFloat(document.getElementById('power').value);
                    I2 = P / V2;
                } else {
                    I2 = parseFloat(document.getElementById('secondaryCurrent').value);
                    P = V2 * I2;
                }
                
                const Acore = Acore_cm2 / 10000 * 0.95;
                const N1 = Math.round(V1 / (4.44 * f * Bmax * Acore));
                const N2 = Math.round(V2 / (4.44 * f * Bmax * Acore));
                const I1 = P / (V1 * 0.95);
                
                const A1 = I1 / J;
                const A2 = I2 / J;
                const d1 = Math.sqrt((4 * A1) / Math.PI);
                const d2 = Math.sqrt((4 * A2) / Math.PI);
                
                const efficiency = 95 - (P / 100);
                const powerDensity = P / Acore_cm2;
                
                // Store calculation data
                transformerCalculationData = {
                    inputs: { V1, V2, P, f, Bmax, J, Acore_cm2 },
                    results: { N1, N2, I1: I1.toFixed(2), I2: I2.toFixed(2), d1: d1.toFixed(2), d2: d2.toFixed(2), efficiency: efficiency.toFixed(1), powerDensity: powerDensity.toFixed(2) }
                };
                
                // Build results HTML
                let html = `
                    <div class="result-section">
                        <h3>Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ</h3>
                        <div class="result-item">
                            <span class="result-label">Ø¯ÙˆØ± Ø§ÙˆÙ„ÛŒÙ‡ (Nâ‚):</span>
                            <span class="result-value">${N1}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø¯ÙˆØ± Ø«Ø§Ù†ÙˆÛŒÙ‡ (Nâ‚‚):</span>
                            <span class="result-value">${N2}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø¬Ø±ÛŒØ§Ù† Ø§ÙˆÙ„ÛŒÙ‡:</span>
                            <span class="result-value">${I1.toFixed(2)} A</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø¬Ø±ÛŒØ§Ù† Ø«Ø§Ù†ÙˆÛŒÙ‡:</span>
                            <span class="result-value">${I2.toFixed(2)} A</span>
                        </div>
                    </div>
                    <div class="result-section">
                        <h3>Ø³ÛŒÙ…â€ŒÙ‡Ø§</h3>
                        <div class="result-item">
                            <span class="result-label">Ù‚Ø·Ø± Ø³ÛŒÙ… Ø§ÙˆÙ„ÛŒÙ‡:</span>
                            <span class="result-value">${d1.toFixed(2)} mm</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ù‚Ø·Ø± Ø³ÛŒÙ… Ø«Ø§Ù†ÙˆÛŒÙ‡:</span>
                            <span class="result-value">${d2.toFixed(2)} mm</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Ø¨Ø§Ø²Ø¯Ù‡:</span>
                            <span class="result-value">${efficiency.toFixed(1)}%</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ØªØ±Ø§Ú©Ù… ØªÙˆØ§Ù†:</span>
                            <span class="result-value">${powerDensity.toFixed(2)} VA/cmÂ²</span>
                        </div>
                    </div>
                `;
                
                // Check for warnings
                const warnings = [];
                if (Bmax > 1.4) warnings.push(`Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± Ø¨Ø§Ù„Ø§ (${Bmax} T)`);
                if (J > 3.5) warnings.push(`Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† Ø¨Ø§Ù„Ø§ (${J} A/mmÂ²)`);
                if (powerDensity > 2) warnings.push(`ØªØ±Ø§Ú©Ù… ØªÙˆØ§Ù† Ø¨Ø§Ù„Ø§ (${powerDensity.toFixed(2)} VA/cmÂ²)`);
                
                if (warnings.length > 0) {
                    html += `
                        <div class="result-section" style="border-color: #f87171;">
                            <h3 style="color: #991b1b;">âš ï¸ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§</h3>
                            ${warnings.map(w => `<div class="result-item"><span class="result-label">${w}</span></div>`).join('')}
                        </div>
                    `;
                }
                
                document.getElementById('transformerResults').innerHTML = html;
                document.getElementById('transformerExportBtn').classList.remove('hidden');
                
                btn.disabled = false;
                btnText.innerHTML = 'Ù…Ø­Ø§Ø³Ø¨Ù‡';
                
                playSound('success');
            }, 800);
        }
        
        // ========== EXCEL EXPORT ==========
        function exportMotorToExcel() {
            if (!motorCalculationData) return;
            
            const wb = XLSX.utils.book_new();
            const wsData = [
                ['Ù¾Ø§Ø±Ø§Ù…ØªØ±', 'Ù…Ù‚Ø¯Ø§Ø±'],
                ['ØªÙˆØ§Ù† (kW)', motorCalculationData.inputs.P_kW],
                ['ÙˆÙ„ØªØ§Ú˜ (V)', motorCalculationData.inputs.V_line],
                ['Ø¬Ø±ÛŒØ§Ù† (A)', motorCalculationData.inputs.I],
                ['ÙØ±Ú©Ø§Ù†Ø³ (Hz)', motorCalculationData.inputs.f],
                ['Ø³Ø±Ø¹Øª (RPM)', motorCalculationData.inputs.Nr],
                ['ØªØ¹Ø¯Ø§Ø¯ Ø´ÛŒØ§Ø±Ù‡Ø§', motorCalculationData.inputs.Z],
                ['ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø·Ø¨â€ŒÙ‡Ø§', motorCalculationData.inputs.P_poles],
                ['Ù†ÙˆØ¹ Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ', motorCalculationData.inputs.windingType === 'full' ? 'Ú¯Ø§Ù… Ú©Ø§Ù…Ù„' : 'Ú¯Ø§Ù… Ú©Ø³Ø±ÛŒ'],
                ['Ù‚Ø·Ø± Ø³ÛŒÙ… (mm)', motorCalculationData.inputs.d_wire],
                ['Ø§ØªØµØ§Ù„', motorCalculationData.inputs.connectionType === 'star' ? 'Ø³ØªØ§Ø±Ù‡' : 'Ù…Ø«Ù„Ø«'],
                [],
                ['Ù†ØªØ§ÛŒØ¬ Ù…Ø­Ø§Ø³Ø¨Ø§Øª'],
                ['Ø³Ø±Ø¹Øª Ø³Ù†Ú©Ø±ÙˆÙ† (RPM)', motorCalculationData.results.Ns.toFixed(0)],
                ['Ù„ØºØ²Ø´ (%)', motorCalculationData.results.S],
                ['Ú¯Ø§Ù… Ù‚Ø·Ø¨ÛŒ', motorCalculationData.results.YP.toFixed(2)],
                ['q', motorCalculationData.results.q.toFixed(2)],
                ['Ú¯Ø§Ù… Ø³ÛŒÙ…â€ŒÙ¾ÛŒÚ†ÛŒ', motorCalculationData.results.YZ],
                ['Ø¯ÙˆØ± Ú©Ø§Ù„Ù', motorCalculationData.results.turnsPerCoil],
                ['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)', motorCalculationData.results.J],
                ['Ø·ÙˆÙ„ Ø³ÛŒÙ… (m)', motorCalculationData.results.totalWireLength]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±');
            XLSX.writeFile(wb, `Ø§Ù„Ú©ØªØ±ÙˆÙ…ÙˆØªÙˆØ±_${new Date().toISOString().split('T')[0]}.xlsx`);
        }
        
        function exportTransformerToExcel() {
            if (!transformerCalculationData) return;
            
            const wb = XLSX.utils.book_new();
            const wsData = [
                ['Ù¾Ø§Ø±Ø§Ù…ØªØ±', 'Ù…Ù‚Ø¯Ø§Ø±'],
                ['ÙˆÙ„ØªØ§Ú˜ Ø§ÙˆÙ„ÛŒÙ‡ (V)', transformerCalculationData.inputs.V1],
                ['ÙˆÙ„ØªØ§Ú˜ Ø«Ø§Ù†ÙˆÛŒÙ‡ (V)', transformerCalculationData.inputs.V2],
                ['ØªÙˆØ§Ù† (VA)', transformerCalculationData.inputs.P],
                ['ÙØ±Ú©Ø§Ù†Ø³ (Hz)', transformerCalculationData.inputs.f],
                ['Ú†Ú¯Ø§Ù„ÛŒ Ø´Ø§Ø± (T)', transformerCalculationData.inputs.Bmax],
                ['Ú†Ú¯Ø§Ù„ÛŒ Ø¬Ø±ÛŒØ§Ù† (A/mmÂ²)', transformerCalculationData.inputs.J],
                ['Ø³Ø·Ø­ Ù‡Ø³ØªÙ‡ (cmÂ²)', transformerCalculationData.inputs.Acore_cm2],
                [],
                ['Ù†ØªØ§ÛŒØ¬ Ù…Ø­Ø§Ø³Ø¨Ø§Øª'],
                ['Ø¯ÙˆØ± Ø§ÙˆÙ„ÛŒÙ‡ (Nâ‚)', transformerCalculationData.results.N1],
                ['Ø¯ÙˆØ± Ø«Ø§Ù†ÙˆÛŒÙ‡ (Nâ‚‚)', transformerCalculationData.results.N2],
                ['Ø¬Ø±ÛŒØ§Ù† Ø§ÙˆÙ„ÛŒÙ‡ (A)', transformerCalculationData.results.I1],
                ['Ø¬Ø±ÛŒØ§Ù† Ø«Ø§Ù†ÙˆÛŒÙ‡ (A)', transformerCalculationData.results.I2],
                ['Ù‚Ø·Ø± Ø³ÛŒÙ… Ø§ÙˆÙ„ÛŒÙ‡ (mm)', transformerCalculationData.results.d1],
                ['Ù‚Ø·Ø± Ø³ÛŒÙ… Ø«Ø§Ù†ÙˆÛŒÙ‡ (mm)', transformerCalculationData.results.d2],
                ['Ø¨Ø§Ø²Ø¯Ù‡ (%)', transformerCalculationData.results.efficiency],
                ['ØªØ±Ø§Ú©Ù… ØªÙˆØ§Ù† (VA/cmÂ²)', transformerCalculationData.results.powerDensity]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, 'ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±');
            XLSX.writeFile(wb, `ØªØ±Ø§Ù†Ø³ÙÙˆØ±Ù…Ø§ØªÙˆØ±_${new Date().toISOString().split('T')[0]}.xlsx`);
        }
        
        // Initialize the system
        window.addEventListener('DOMContentLoaded', initSystem);
    </script>
</body>
</html>
